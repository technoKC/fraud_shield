{"ast":null,"code":"import { select } from 'd3-selection';\nimport { zoomTransform, zoom } from 'd3-zoom';\nimport { drag } from 'd3-drag';\nimport { sum, min, max } from 'd3-array';\nimport { throttle } from 'lodash-es';\nimport { Group, Tween, Easing } from '@tweenjs/tween.js';\nimport Kapsule from 'kapsule';\nimport accessorFn from 'accessor-fn';\nimport ColorTracker from 'canvas-color-tracker';\nimport Tooltip from 'float-tooltip';\nimport { forceRadial, forceSimulation, forceLink, forceManyBody, forceCenter } from 'd3-force-3d';\nimport { Bezier } from 'bezier-js';\nimport indexBy from 'index-array-by';\nimport { scaleOrdinal } from 'd3-scale';\nimport { schemePaired } from 'd3-scale-chromatic';\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n  if (typeof document === 'undefined') {\n    return;\n  }\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\nvar css_248z = \".force-graph-container canvas {\\n  display: block;\\n  user-select: none;\\n  outline: none;\\n  -webkit-tap-highlight-color: transparent;\\n}\\n\\n.force-graph-container .clickable {\\n  cursor: pointer;\\n}\\n\\n.force-graph-container .grabbable {\\n  cursor: move;\\n  cursor: grab;\\n  cursor: -moz-grab;\\n  cursor: -webkit-grab;\\n}\\n\\n.force-graph-container .grabbable:active {\\n  cursor: grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: -webkit-grabbing;\\n}\\n\";\nstyleInject(css_248z);\nfunction _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nfunction _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return _arrayLikeToArray(r);\n}\nfunction _construct(t, e, r) {\n  if (_isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments);\n  var o = [null];\n  o.push.apply(o, e);\n  var p = new (t.bind.apply(t, o))();\n  return p;\n}\nfunction _defineProperty(e, r, t) {\n  return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: true,\n    configurable: true,\n    writable: true\n  }) : e[r] = t, e;\n}\nfunction _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (_isNativeReflectConstruct = function () {\n    return !!t;\n  })();\n}\nfunction _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nfunction _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = true,\n      o = false;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) ;else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = true, n = r;\n    } finally {\n      try {\n        if (!f && null != t.return && (u = t.return(), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), true).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nfunction _slicedToArray(r, e) {\n  return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest();\n}\nfunction _toConsumableArray(r) {\n  return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread();\n}\nfunction _toPrimitive(t, r) {\n  if (\"object\" != typeof t || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r);\n    if (\"object\" != typeof i) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nfunction _toPropertyKey(t) {\n  var i = _toPrimitive(t, \"string\");\n  return \"symbol\" == typeof i ? i : i + \"\";\n}\nfunction _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return _arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0;\n  }\n}\nvar autoColorScale = scaleOrdinal(schemePaired);\n\n// Autoset attribute colorField by colorByAccessor property\n// If an object has already a color, don't set it\n// Objects can be nodes or links\nfunction autoColorObjects(objects, colorByAccessor, colorField) {\n  if (!colorByAccessor || typeof colorField !== 'string') return;\n  objects.filter(function (obj) {\n    return !obj[colorField];\n  }).forEach(function (obj) {\n    obj[colorField] = autoColorScale(colorByAccessor(obj));\n  });\n}\nfunction getDagDepths(_ref, idAccessor) {\n  var nodes = _ref.nodes,\n    links = _ref.links;\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n    _ref2$nodeFilter = _ref2.nodeFilter,\n    nodeFilter = _ref2$nodeFilter === void 0 ? function () {\n      return true;\n    } : _ref2$nodeFilter,\n    _ref2$onLoopError = _ref2.onLoopError,\n    onLoopError = _ref2$onLoopError === void 0 ? function (loopIds) {\n      throw \"Invalid DAG structure! Found cycle in node path: \".concat(loopIds.join(' -> '), \".\");\n    } : _ref2$onLoopError;\n  // linked graph\n  var graph = {};\n  nodes.forEach(function (node) {\n    return graph[idAccessor(node)] = {\n      data: node,\n      out: [],\n      depth: -1,\n      skip: !nodeFilter(node)\n    };\n  });\n  links.forEach(function (_ref3) {\n    var source = _ref3.source,\n      target = _ref3.target;\n    var sourceId = getNodeId(source);\n    var targetId = getNodeId(target);\n    if (!graph.hasOwnProperty(sourceId)) throw \"Missing source node with id: \".concat(sourceId);\n    if (!graph.hasOwnProperty(targetId)) throw \"Missing target node with id: \".concat(targetId);\n    var sourceNode = graph[sourceId];\n    var targetNode = graph[targetId];\n    sourceNode.out.push(targetNode);\n    function getNodeId(node) {\n      return _typeof(node) === 'object' ? idAccessor(node) : node;\n    }\n  });\n  var foundLoops = [];\n  traverse(Object.values(graph));\n  var nodeDepths = Object.assign.apply(Object, [{}].concat(_toConsumableArray(Object.entries(graph).filter(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n      node = _ref5[1];\n    return !node.skip;\n  }).map(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n      id = _ref7[0],\n      node = _ref7[1];\n    return _defineProperty({}, id, node.depth);\n  }))));\n  return nodeDepths;\n  function traverse(nodes) {\n    var nodeStack = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var currentDepth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var _loop = function _loop() {\n      var node = nodes[i];\n      if (nodeStack.indexOf(node) !== -1) {\n        var loop = [].concat(_toConsumableArray(nodeStack.slice(nodeStack.indexOf(node))), [node]).map(function (d) {\n          return idAccessor(d.data);\n        });\n        if (!foundLoops.some(function (foundLoop) {\n          return foundLoop.length === loop.length && foundLoop.every(function (id, idx) {\n            return id === loop[idx];\n          });\n        })) {\n          foundLoops.push(loop);\n          onLoopError(loop);\n        }\n        return 1; // continue\n      }\n      if (currentDepth > node.depth) {\n        // Don't unnecessarily revisit chunks of the graph\n        node.depth = currentDepth;\n        traverse(node.out, [].concat(_toConsumableArray(nodeStack), [node]), currentDepth + (node.skip ? 0 : 1));\n      }\n    };\n    for (var i = 0, l = nodes.length; i < l; i++) {\n      if (_loop()) continue;\n    }\n  }\n}\n\n//\n\nvar DAG_LEVEL_NODE_RATIO = 2;\n\n// whenever styling props are changed that require a canvas redraw\nvar notifyRedraw = function notifyRedraw(_, state) {\n  return state.onNeedsRedraw && state.onNeedsRedraw();\n};\nvar updDataPhotons = function updDataPhotons(_, state) {\n  if (!state.isShadow) {\n    // Add photon particles\n    var linkParticlesAccessor = accessorFn(state.linkDirectionalParticles);\n    state.graphData.links.forEach(function (link) {\n      var numPhotons = Math.round(Math.abs(linkParticlesAccessor(link)));\n      if (numPhotons) {\n        link.__photons = _toConsumableArray(Array(numPhotons)).map(function () {\n          return {};\n        });\n      } else {\n        delete link.__photons;\n      }\n    });\n  }\n};\nvar CanvasForceGraph = Kapsule({\n  props: {\n    graphData: {\n      \"default\": {\n        nodes: [],\n        links: []\n      },\n      onChange: function onChange(_, state) {\n        state.engineRunning = false; // Pause simulation\n        updDataPhotons(_, state);\n      }\n    },\n    dagMode: {\n      onChange: function onChange(dagMode, state) {\n        // td, bu, lr, rl, radialin, radialout\n        !dagMode && (state.graphData.nodes || []).forEach(function (n) {\n          return n.fx = n.fy = undefined;\n        }); // unfix nodes when disabling dag mode\n      }\n    },\n    dagLevelDistance: {},\n    dagNodeFilter: {\n      \"default\": function _default(node) {\n        return true;\n      }\n    },\n    onDagError: {\n      triggerUpdate: false\n    },\n    nodeRelSize: {\n      \"default\": 4,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    // area per val unit\n    nodeId: {\n      \"default\": 'id'\n    },\n    nodeVal: {\n      \"default\": 'val',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeColor: {\n      \"default\": 'color',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeAutoColorBy: {},\n    nodeCanvasObject: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeCanvasObjectMode: {\n      \"default\": function _default() {\n        return 'replace';\n      },\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeVisibility: {\n      \"default\": true,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkSource: {\n      \"default\": 'source'\n    },\n    linkTarget: {\n      \"default\": 'target'\n    },\n    linkVisibility: {\n      \"default\": true,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkColor: {\n      \"default\": 'color',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkAutoColorBy: {},\n    linkLineDash: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkWidth: {\n      \"default\": 1,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCurvature: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCanvasObject: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCanvasObjectMode: {\n      \"default\": function _default() {\n        return 'replace';\n      },\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowLength: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowColor: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowRelPos: {\n      \"default\": 0.5,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    // value between 0<>1 indicating the relative pos along the (exposed) line\n    linkDirectionalParticles: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: updDataPhotons\n    },\n    // animate photons travelling in the link direction\n    linkDirectionalParticleSpeed: {\n      \"default\": 0.01,\n      triggerUpdate: false\n    },\n    // in link length ratio per frame\n    linkDirectionalParticleOffset: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    // starting position offset along the link's length, like a pre-delay. Values between [0, 1]\n    linkDirectionalParticleWidth: {\n      \"default\": 4,\n      triggerUpdate: false\n    },\n    linkDirectionalParticleColor: {\n      triggerUpdate: false\n    },\n    linkDirectionalParticleCanvasObject: {\n      triggerUpdate: false\n    },\n    globalScale: {\n      \"default\": 1,\n      triggerUpdate: false\n    },\n    d3AlphaMin: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    d3AlphaDecay: {\n      \"default\": 0.0228,\n      triggerUpdate: false,\n      onChange: function onChange(alphaDecay, state) {\n        state.forceLayout.alphaDecay(alphaDecay);\n      }\n    },\n    d3AlphaTarget: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: function onChange(alphaTarget, state) {\n        state.forceLayout.alphaTarget(alphaTarget);\n      }\n    },\n    d3VelocityDecay: {\n      \"default\": 0.4,\n      triggerUpdate: false,\n      onChange: function onChange(velocityDecay, state) {\n        state.forceLayout.velocityDecay(velocityDecay);\n      }\n    },\n    warmupTicks: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    // how many times to tick the force engine at init before starting to render\n    cooldownTicks: {\n      \"default\": Infinity,\n      triggerUpdate: false\n    },\n    cooldownTime: {\n      \"default\": 15000,\n      triggerUpdate: false\n    },\n    // ms\n    onUpdate: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onFinishUpdate: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onEngineTick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onEngineStop: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNeedsRedraw: {\n      triggerUpdate: false\n    },\n    isShadow: {\n      \"default\": false,\n      triggerUpdate: false\n    }\n  },\n  methods: {\n    // Expose d3 forces for external manipulation\n    d3Force: function d3Force(state, forceName, forceFn) {\n      if (forceFn === undefined) {\n        return state.forceLayout.force(forceName); // Force getter\n      }\n      state.forceLayout.force(forceName, forceFn); // Force setter\n      return this;\n    },\n    d3ReheatSimulation: function d3ReheatSimulation(state) {\n      state.forceLayout.alpha(1);\n      this.resetCountdown();\n      return this;\n    },\n    // reset cooldown state\n    resetCountdown: function resetCountdown(state) {\n      state.cntTicks = 0;\n      state.startTickTime = new Date();\n      state.engineRunning = true;\n      return this;\n    },\n    isEngineRunning: function isEngineRunning(state) {\n      return !!state.engineRunning;\n    },\n    tickFrame: function tickFrame(state) {\n      !state.isShadow && layoutTick();\n      paintLinks();\n      !state.isShadow && paintArrows();\n      !state.isShadow && paintPhotons();\n      paintNodes();\n      return this;\n\n      //\n\n      function layoutTick() {\n        if (state.engineRunning) {\n          if (++state.cntTicks > state.cooldownTicks || new Date() - state.startTickTime > state.cooldownTime || state.d3AlphaMin > 0 && state.forceLayout.alpha() < state.d3AlphaMin) {\n            state.engineRunning = false; // Stop ticking graph\n            state.onEngineStop();\n          } else {\n            state.forceLayout.tick(); // Tick it\n            state.onEngineTick();\n          }\n        }\n      }\n      function paintNodes() {\n        var getVisibility = accessorFn(state.nodeVisibility);\n        var getVal = accessorFn(state.nodeVal);\n        var getColor = accessorFn(state.nodeColor);\n        var getNodeCanvasObjectMode = accessorFn(state.nodeCanvasObjectMode);\n        var ctx = state.ctx;\n\n        // Draw wider nodes by 1px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n        var padAmount = state.isShadow / state.globalScale;\n        var visibleNodes = state.graphData.nodes.filter(getVisibility);\n        ctx.save();\n        visibleNodes.forEach(function (node) {\n          var nodeCanvasObjectMode = getNodeCanvasObjectMode(node);\n          if (state.nodeCanvasObject && (nodeCanvasObjectMode === 'before' || nodeCanvasObjectMode === 'replace')) {\n            // Custom node before/replace paint\n            state.nodeCanvasObject(node, ctx, state.globalScale);\n            if (nodeCanvasObjectMode === 'replace') {\n              ctx.restore();\n              return;\n            }\n          }\n\n          // Draw wider nodes by 1px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n          var r = Math.sqrt(Math.max(0, getVal(node) || 1)) * state.nodeRelSize + padAmount;\n          ctx.beginPath();\n          ctx.arc(node.x, node.y, r, 0, 2 * Math.PI, false);\n          ctx.fillStyle = getColor(node) || 'rgba(31, 120, 180, 0.92)';\n          ctx.fill();\n          if (state.nodeCanvasObject && nodeCanvasObjectMode === 'after') {\n            // Custom node after paint\n            state.nodeCanvasObject(node, state.ctx, state.globalScale);\n          }\n        });\n        ctx.restore();\n      }\n      function paintLinks() {\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkColor);\n        var getWidth = accessorFn(state.linkWidth);\n        var getLineDash = accessorFn(state.linkLineDash);\n        var getCurvature = accessorFn(state.linkCurvature);\n        var getLinkCanvasObjectMode = accessorFn(state.linkCanvasObjectMode);\n        var ctx = state.ctx;\n\n        // Draw wider lines by 2px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n        var padAmount = state.isShadow * 2;\n        var visibleLinks = state.graphData.links.filter(getVisibility);\n        visibleLinks.forEach(calcLinkControlPoints); // calculate curvature control points for all visible links\n\n        var beforeCustomLinks = [],\n          afterCustomLinks = [],\n          defaultPaintLinks = visibleLinks;\n        if (state.linkCanvasObject) {\n          var replaceCustomLinks = [],\n            otherCustomLinks = [];\n          visibleLinks.forEach(function (d) {\n            return ({\n              before: beforeCustomLinks,\n              after: afterCustomLinks,\n              replace: replaceCustomLinks\n            }[getLinkCanvasObjectMode(d)] || otherCustomLinks).push(d);\n          });\n          defaultPaintLinks = [].concat(_toConsumableArray(beforeCustomLinks), afterCustomLinks, otherCustomLinks);\n          beforeCustomLinks = beforeCustomLinks.concat(replaceCustomLinks);\n        }\n\n        // Custom link before paints\n        ctx.save();\n        beforeCustomLinks.forEach(function (link) {\n          return state.linkCanvasObject(link, ctx, state.globalScale);\n        });\n        ctx.restore();\n\n        // Bundle strokes per unique color/width/dash for performance optimization\n        var linksPerColor = indexBy(defaultPaintLinks, [getColor, getWidth, getLineDash]);\n        ctx.save();\n        Object.entries(linksPerColor).forEach(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n            color = _ref2[0],\n            linksPerWidth = _ref2[1];\n          var lineColor = !color || color === 'undefined' ? 'rgba(0,0,0,0.15)' : color;\n          Object.entries(linksPerWidth).forEach(function (_ref3) {\n            var _ref4 = _slicedToArray(_ref3, 2),\n              width = _ref4[0],\n              linesPerLineDash = _ref4[1];\n            var lineWidth = (width || 1) / state.globalScale + padAmount;\n            Object.entries(linesPerLineDash).forEach(function (_ref5) {\n              var _ref6 = _slicedToArray(_ref5, 2);\n              _ref6[0];\n              var links = _ref6[1];\n              var lineDashSegments = getLineDash(links[0]);\n              ctx.beginPath();\n              links.forEach(function (link) {\n                var start = link.source;\n                var end = link.target;\n                if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n                ctx.moveTo(start.x, start.y);\n                var controlPoints = link.__controlPoints;\n                if (!controlPoints) {\n                  // Straight line\n                  ctx.lineTo(end.x, end.y);\n                } else {\n                  // Use quadratic curves for regular lines and bezier for loops\n                  ctx[controlPoints.length === 2 ? 'quadraticCurveTo' : 'bezierCurveTo'].apply(ctx, _toConsumableArray(controlPoints).concat([end.x, end.y]));\n                }\n              });\n              ctx.strokeStyle = lineColor;\n              ctx.lineWidth = lineWidth;\n              ctx.setLineDash(lineDashSegments || []);\n              ctx.stroke();\n            });\n          });\n        });\n        ctx.restore();\n\n        // Custom link after paints\n        ctx.save();\n        afterCustomLinks.forEach(function (link) {\n          return state.linkCanvasObject(link, ctx, state.globalScale);\n        });\n        ctx.restore();\n\n        //\n\n        function calcLinkControlPoints(link) {\n          var curvature = getCurvature(link);\n          if (!curvature) {\n            // straight line\n            link.__controlPoints = null;\n            return;\n          }\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var l = Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2)); // line length\n\n          if (l > 0) {\n            var a = Math.atan2(end.y - start.y, end.x - start.x); // line angle\n            var d = l * curvature; // control point distance\n\n            var cp = {\n              // control point\n              x: (start.x + end.x) / 2 + d * Math.cos(a - Math.PI / 2),\n              y: (start.y + end.y) / 2 + d * Math.sin(a - Math.PI / 2)\n            };\n            link.__controlPoints = [cp.x, cp.y];\n          } else {\n            // Same point, draw a loop\n            var _d = curvature * 70;\n            link.__controlPoints = [end.x, end.y - _d, end.x + _d, end.y];\n          }\n        }\n      }\n      function paintArrows() {\n        var ARROW_WH_RATIO = 1.6;\n        var ARROW_VLEN_RATIO = 0.2;\n        var getLength = accessorFn(state.linkDirectionalArrowLength);\n        var getRelPos = accessorFn(state.linkDirectionalArrowRelPos);\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkDirectionalArrowColor || state.linkColor);\n        var getNodeVal = accessorFn(state.nodeVal);\n        var ctx = state.ctx;\n        ctx.save();\n        state.graphData.links.filter(getVisibility).forEach(function (link) {\n          var arrowLength = getLength(link);\n          if (!arrowLength || arrowLength < 0) return;\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var startR = Math.sqrt(Math.max(0, getNodeVal(start) || 1)) * state.nodeRelSize;\n          var endR = Math.sqrt(Math.max(0, getNodeVal(end) || 1)) * state.nodeRelSize;\n          var arrowRelPos = Math.min(1, Math.max(0, getRelPos(link)));\n          var arrowColor = getColor(link) || 'rgba(0,0,0,0.28)';\n          var arrowHalfWidth = arrowLength / ARROW_WH_RATIO / 2;\n\n          // Construct bezier for curved lines\n          var bzLine = link.__controlPoints && _construct(Bezier, [start.x, start.y].concat(_toConsumableArray(link.__controlPoints), [end.x, end.y]));\n          var getCoordsAlongLine = bzLine ? function (t) {\n            return bzLine.get(t);\n          } // get position along bezier line\n          : function (t) {\n            return {\n              // straight line: interpolate linearly\n              x: start.x + (end.x - start.x) * t || 0,\n              y: start.y + (end.y - start.y) * t || 0\n            };\n          };\n          var lineLen = bzLine ? bzLine.length() : Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2));\n          var posAlongLine = startR + arrowLength + (lineLen - startR - endR - arrowLength) * arrowRelPos;\n          var arrowHead = getCoordsAlongLine(posAlongLine / lineLen);\n          var arrowTail = getCoordsAlongLine((posAlongLine - arrowLength) / lineLen);\n          var arrowTailVertex = getCoordsAlongLine((posAlongLine - arrowLength * (1 - ARROW_VLEN_RATIO)) / lineLen);\n          var arrowTailAngle = Math.atan2(arrowHead.y - arrowTail.y, arrowHead.x - arrowTail.x) - Math.PI / 2;\n          ctx.beginPath();\n          ctx.moveTo(arrowHead.x, arrowHead.y);\n          ctx.lineTo(arrowTail.x + arrowHalfWidth * Math.cos(arrowTailAngle), arrowTail.y + arrowHalfWidth * Math.sin(arrowTailAngle));\n          ctx.lineTo(arrowTailVertex.x, arrowTailVertex.y);\n          ctx.lineTo(arrowTail.x - arrowHalfWidth * Math.cos(arrowTailAngle), arrowTail.y - arrowHalfWidth * Math.sin(arrowTailAngle));\n          ctx.fillStyle = arrowColor;\n          ctx.fill();\n        });\n        ctx.restore();\n      }\n      function paintPhotons() {\n        var getNumPhotons = accessorFn(state.linkDirectionalParticles);\n        var getSpeed = accessorFn(state.linkDirectionalParticleSpeed);\n        var getOffset = accessorFn(state.linkDirectionalParticleOffset);\n        var getDiameter = accessorFn(state.linkDirectionalParticleWidth);\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkDirectionalParticleColor || state.linkColor);\n        var ctx = state.ctx;\n        ctx.save();\n        state.graphData.links.filter(getVisibility).forEach(function (link) {\n          var numCyclePhotons = getNumPhotons(link);\n          if (!link.hasOwnProperty('__photons') || !link.__photons.length) return;\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var particleSpeed = getSpeed(link);\n          var particleOffset = Math.abs(getOffset(link));\n          var photons = link.__photons || [];\n          var photonR = Math.max(0, getDiameter(link) / 2) / Math.sqrt(state.globalScale);\n          var photonColor = getColor(link) || 'rgba(0,0,0,0.28)';\n          ctx.fillStyle = photonColor;\n\n          // Construct bezier for curved lines\n          var bzLine = link.__controlPoints ? _construct(Bezier, [start.x, start.y].concat(_toConsumableArray(link.__controlPoints), [end.x, end.y])) : null;\n          var cyclePhotonIdx = 0;\n          var needsCleanup = false; // whether some photons need to be removed from list\n          photons.forEach(function (photon) {\n            var singleHop = !!photon.__singleHop;\n            if (!photon.hasOwnProperty('__progressRatio')) {\n              photon.__progressRatio = singleHop ? 0 : (cyclePhotonIdx + particleOffset) / numCyclePhotons;\n            }\n            !singleHop && cyclePhotonIdx++; // increase regular photon index\n\n            photon.__progressRatio += particleSpeed;\n            if (photon.__progressRatio >= 1) {\n              if (!singleHop) {\n                photon.__progressRatio = photon.__progressRatio % 1;\n              } else {\n                needsCleanup = true;\n                return;\n              }\n            }\n            var photonPosRatio = photon.__progressRatio;\n            var coords = bzLine ? bzLine.get(photonPosRatio) // get position along bezier line\n            : {\n              // straight line: interpolate linearly\n              x: start.x + (end.x - start.x) * photonPosRatio || 0,\n              y: start.y + (end.y - start.y) * photonPosRatio || 0\n            };\n            if (state.linkDirectionalParticleCanvasObject) {\n              state.linkDirectionalParticleCanvasObject(coords.x, coords.y, link, ctx, state.globalScale);\n            } else {\n              ctx.beginPath();\n              ctx.arc(coords.x, coords.y, photonR, 0, 2 * Math.PI, false);\n              ctx.fill();\n            }\n          });\n          if (needsCleanup) {\n            // remove expired single hop photons\n            link.__photons = link.__photons.filter(function (photon) {\n              return !photon.__singleHop || photon.__progressRatio <= 1;\n            });\n          }\n        });\n        ctx.restore();\n      }\n    },\n    emitParticle: function emitParticle(state, link) {\n      if (link) {\n        !link.__photons && (link.__photons = []);\n        link.__photons.push({\n          __singleHop: true\n        }); // add a single hop particle\n      }\n      return this;\n    }\n  },\n  stateInit: function stateInit() {\n    return {\n      forceLayout: forceSimulation().force('link', forceLink()).force('charge', forceManyBody()).force('center', forceCenter()).force('dagRadial', null).stop(),\n      engineRunning: false\n    };\n  },\n  init: function init(canvasCtx, state) {\n    // Main canvas object to manipulate\n    state.ctx = canvasCtx;\n  },\n  update: function update(state, changedProps) {\n    state.engineRunning = false; // Pause simulation\n    state.onUpdate();\n    if (state.nodeAutoColorBy !== null) {\n      // Auto add color to uncolored nodes\n      autoColorObjects(state.graphData.nodes, accessorFn(state.nodeAutoColorBy), state.nodeColor);\n    }\n    if (state.linkAutoColorBy !== null) {\n      // Auto add color to uncolored links\n      autoColorObjects(state.graphData.links, accessorFn(state.linkAutoColorBy), state.linkColor);\n    }\n\n    // parse links\n    state.graphData.links.forEach(function (link) {\n      link.source = link[state.linkSource];\n      link.target = link[state.linkTarget];\n    });\n\n    // Feed data to force-directed layout\n    state.forceLayout.stop().alpha(1) // re-heat the simulation\n    .nodes(state.graphData.nodes);\n\n    // add links (if link force is still active)\n    var linkForce = state.forceLayout.force('link');\n    if (linkForce) {\n      linkForce.id(function (d) {\n        return d[state.nodeId];\n      }).links(state.graphData.links);\n    }\n\n    // setup dag force constraints\n    var nodeDepths = state.dagMode && getDagDepths(state.graphData, function (node) {\n      return node[state.nodeId];\n    }, {\n      nodeFilter: state.dagNodeFilter,\n      onLoopError: state.onDagError || undefined\n    });\n    var maxDepth = Math.max.apply(Math, _toConsumableArray(Object.values(nodeDepths || [])));\n    var dagLevelDistance = state.dagLevelDistance || state.graphData.nodes.length / (maxDepth || 1) * DAG_LEVEL_NODE_RATIO * (['radialin', 'radialout'].indexOf(state.dagMode) !== -1 ? 0.7 : 1);\n\n    // Reset relevant fx/fy when swapping dag modes\n    if (['lr', 'rl', 'td', 'bu'].includes(changedProps.dagMode)) {\n      var resetProp = ['lr', 'rl'].includes(changedProps.dagMode) ? 'fx' : 'fy';\n      state.graphData.nodes.filter(state.dagNodeFilter).forEach(function (node) {\n        return delete node[resetProp];\n      });\n    }\n\n    // Fix nodes to x,y for dag mode\n    if (['lr', 'rl', 'td', 'bu'].includes(state.dagMode)) {\n      var invert = ['rl', 'bu'].includes(state.dagMode);\n      var fixFn = function fixFn(node) {\n        return (nodeDepths[node[state.nodeId]] - maxDepth / 2) * dagLevelDistance * (invert ? -1 : 1);\n      };\n      var _resetProp = ['lr', 'rl'].includes(state.dagMode) ? 'fx' : 'fy';\n      state.graphData.nodes.filter(state.dagNodeFilter).forEach(function (node) {\n        return node[_resetProp] = fixFn(node);\n      });\n    }\n\n    // Use radial force for radial dags\n    state.forceLayout.force('dagRadial', ['radialin', 'radialout'].indexOf(state.dagMode) !== -1 ? forceRadial(function (node) {\n      var nodeDepth = nodeDepths[node[state.nodeId]] || -1;\n      return (state.dagMode === 'radialin' ? maxDepth - nodeDepth : nodeDepth) * dagLevelDistance;\n    }).strength(function (node) {\n      return state.dagNodeFilter(node) ? 1 : 0;\n    }) : null);\n    for (var i = 0; i < state.warmupTicks && !(state.d3AlphaMin > 0 && state.forceLayout.alpha() < state.d3AlphaMin); i++) {\n      state.forceLayout.tick();\n    } // Initial ticks before starting to render\n\n    this.resetCountdown();\n    state.onFinishUpdate();\n  }\n});\nfunction linkKapsule(kapsulePropNames, kapsuleType) {\n  var propNames = kapsulePropNames instanceof Array ? kapsulePropNames : [kapsulePropNames];\n  var dummyK = new kapsuleType(); // To extract defaults\n  dummyK._destructor && dummyK._destructor();\n  return {\n    linkProp: function linkProp(prop) {\n      // link property config\n      return {\n        \"default\": dummyK[prop](),\n        onChange: function onChange(v, state) {\n          propNames.forEach(function (propName) {\n            return state[propName][prop](v);\n          });\n        },\n        triggerUpdate: false\n      };\n    },\n    linkMethod: function linkMethod(method) {\n      // link method pass-through\n      return function (state) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n        var returnVals = [];\n        propNames.forEach(function (propName) {\n          var kapsuleInstance = state[propName];\n          var returnVal = kapsuleInstance[method].apply(kapsuleInstance, args);\n          if (returnVal !== kapsuleInstance) {\n            returnVals.push(returnVal);\n          }\n        });\n        return returnVals.length ? returnVals[0] : this; // chain based on the parent object, not the inner kapsule\n      };\n    }\n  };\n}\nvar HOVER_CANVAS_THROTTLE_DELAY = 800; // ms to throttle shadow canvas updates for perf improvement\nvar ZOOM2NODES_FACTOR = 4;\nvar DRAG_CLICK_TOLERANCE_PX = 5; // How many px can a node be accidentally dragged before disabling the click\n\n// Expose config from forceGraph\nvar bindFG = linkKapsule('forceGraph', CanvasForceGraph);\nvar bindBoth = linkKapsule(['forceGraph', 'shadowGraph'], CanvasForceGraph);\nvar linkedProps = Object.assign.apply(Object, _toConsumableArray(['nodeColor', 'nodeAutoColorBy', 'nodeCanvasObject', 'nodeCanvasObjectMode', 'linkColor', 'linkAutoColorBy', 'linkLineDash', 'linkWidth', 'linkCanvasObject', 'linkCanvasObjectMode', 'linkDirectionalArrowLength', 'linkDirectionalArrowColor', 'linkDirectionalArrowRelPos', 'linkDirectionalParticles', 'linkDirectionalParticleSpeed', 'linkDirectionalParticleOffset', 'linkDirectionalParticleWidth', 'linkDirectionalParticleColor', 'linkDirectionalParticleCanvasObject', 'dagMode', 'dagLevelDistance', 'dagNodeFilter', 'onDagError', 'd3AlphaMin', 'd3AlphaDecay', 'd3VelocityDecay', 'warmupTicks', 'cooldownTicks', 'cooldownTime', 'onEngineTick', 'onEngineStop'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkProp(p));\n})).concat(_toConsumableArray(['nodeRelSize', 'nodeId', 'nodeVal', 'nodeVisibility', 'linkSource', 'linkTarget', 'linkVisibility', 'linkCurvature'].map(function (p) {\n  return _defineProperty({}, p, bindBoth.linkProp(p));\n}))));\nvar linkedMethods = Object.assign.apply(Object, _toConsumableArray(['d3Force', 'd3ReheatSimulation', 'emitParticle'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkMethod(p));\n})));\nfunction adjustCanvasSize(state) {\n  if (state.canvas) {\n    var curWidth = state.canvas.width;\n    var curHeight = state.canvas.height;\n    if (curWidth === 300 && curHeight === 150) {\n      // Default canvas dimensions\n      curWidth = curHeight = 0;\n    }\n    var pxScale = window.devicePixelRatio; // 2 on retina displays\n    curWidth /= pxScale;\n    curHeight /= pxScale;\n\n    // Resize canvases\n    [state.canvas, state.shadowCanvas].forEach(function (canvas) {\n      // Element size\n      canvas.style.width = \"\".concat(state.width, \"px\");\n      canvas.style.height = \"\".concat(state.height, \"px\");\n\n      // Memory size (scaled to avoid blurriness)\n      canvas.width = state.width * pxScale;\n      canvas.height = state.height * pxScale;\n\n      // Normalize coordinate system to use css pixels (on init only)\n      if (!curWidth && !curHeight) {\n        canvas.getContext('2d').scale(pxScale, pxScale);\n      }\n    });\n\n    // Relative center panning based on 0,0\n    var k = zoomTransform(state.canvas).k;\n    state.zoom.translateBy(state.zoom.__baseElem, (state.width - curWidth) / 2 / k, (state.height - curHeight) / 2 / k);\n    state.needsRedraw = true;\n  }\n}\nfunction resetTransform(ctx) {\n  var pxRatio = window.devicePixelRatio;\n  ctx.setTransform(pxRatio, 0, 0, pxRatio, 0, 0);\n}\nfunction clearCanvas(ctx, width, height) {\n  ctx.save();\n  resetTransform(ctx); // reset transform\n  ctx.clearRect(0, 0, width, height);\n  ctx.restore(); //restore transforms\n}\n\n//\n\nvar forceGraph = Kapsule({\n  props: _objectSpread2({\n    width: {\n      \"default\": window.innerWidth,\n      onChange: function onChange(_, state) {\n        return adjustCanvasSize(state);\n      },\n      triggerUpdate: false\n    },\n    height: {\n      \"default\": window.innerHeight,\n      onChange: function onChange(_, state) {\n        return adjustCanvasSize(state);\n      },\n      triggerUpdate: false\n    },\n    graphData: {\n      \"default\": {\n        nodes: [],\n        links: []\n      },\n      onChange: function onChange(d, state) {\n        // Wipe color registry if all objects are new\n        [d.nodes, d.links].every(function (arr) {\n          return (arr || []).every(function (d) {\n            return !d.hasOwnProperty('__indexColor');\n          });\n        }) && state.colorTracker.reset();\n        [{\n          type: 'Node',\n          objs: d.nodes\n        }, {\n          type: 'Link',\n          objs: d.links\n        }].forEach(hexIndex);\n        state.forceGraph.graphData(d);\n        state.shadowGraph.graphData(d);\n        function hexIndex(_ref4) {\n          var type = _ref4.type,\n            objs = _ref4.objs;\n          objs.filter(function (d) {\n            if (!d.hasOwnProperty('__indexColor')) return true;\n            var cur = state.colorTracker.lookup(d.__indexColor);\n            return !cur || !cur.hasOwnProperty('d') || cur.d !== d;\n          }).forEach(function (d) {\n            // store object lookup color\n            d.__indexColor = state.colorTracker.register({\n              type: type,\n              d: d\n            });\n          });\n        }\n      },\n      triggerUpdate: false\n    },\n    backgroundColor: {\n      onChange: function onChange(color, state) {\n        state.canvas && color && (state.canvas.style.background = color);\n      },\n      triggerUpdate: false\n    },\n    nodeLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    nodePointerAreaPaint: {\n      onChange: function onChange(paintFn, state) {\n        state.shadowGraph.nodeCanvasObject(!paintFn ? null : function (node, ctx, globalScale) {\n          return paintFn(node, node.__indexColor, ctx, globalScale);\n        });\n        state.flushShadowCanvas && state.flushShadowCanvas();\n      },\n      triggerUpdate: false\n    },\n    linkPointerAreaPaint: {\n      onChange: function onChange(paintFn, state) {\n        state.shadowGraph.linkCanvasObject(!paintFn ? null : function (link, ctx, globalScale) {\n          return paintFn(link, link.__indexColor, ctx, globalScale);\n        });\n        state.flushShadowCanvas && state.flushShadowCanvas();\n      },\n      triggerUpdate: false\n    },\n    linkLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkHoverPrecision: {\n      \"default\": 4,\n      triggerUpdate: false\n    },\n    minZoom: {\n      \"default\": 0.01,\n      onChange: function onChange(minZoom, state) {\n        state.zoom.scaleExtent([minZoom, state.zoom.scaleExtent()[1]]);\n      },\n      triggerUpdate: false\n    },\n    maxZoom: {\n      \"default\": 1000,\n      onChange: function onChange(maxZoom, state) {\n        state.zoom.scaleExtent([state.zoom.scaleExtent()[0], maxZoom]);\n      },\n      triggerUpdate: false\n    },\n    enableNodeDrag: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enableZoomInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enablePanInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enableZoomPanInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    // to be deprecated\n    enablePointerInteraction: {\n      \"default\": true,\n      onChange: function onChange(_, state) {\n        state.hoverObj = null;\n      },\n      triggerUpdate: false\n    },\n    autoPauseRedraw: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    onNodeDrag: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeDragEnd: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeClick: {\n      triggerUpdate: false\n    },\n    onNodeRightClick: {\n      triggerUpdate: false\n    },\n    onNodeHover: {\n      triggerUpdate: false\n    },\n    onLinkClick: {\n      triggerUpdate: false\n    },\n    onLinkRightClick: {\n      triggerUpdate: false\n    },\n    onLinkHover: {\n      triggerUpdate: false\n    },\n    onBackgroundClick: {\n      triggerUpdate: false\n    },\n    onBackgroundRightClick: {\n      triggerUpdate: false\n    },\n    onZoom: {\n      triggerUpdate: false\n    },\n    onZoomEnd: {\n      triggerUpdate: false\n    },\n    onRenderFramePre: {\n      triggerUpdate: false\n    },\n    onRenderFramePost: {\n      triggerUpdate: false\n    }\n  }, linkedProps),\n  aliases: {\n    // Prop names supported for backwards compatibility\n    stopAnimation: 'pauseAnimation'\n  },\n  methods: _objectSpread2({\n    graph2ScreenCoords: function graph2ScreenCoords(state, x, y) {\n      var t = zoomTransform(state.canvas);\n      return {\n        x: x * t.k + t.x,\n        y: y * t.k + t.y\n      };\n    },\n    screen2GraphCoords: function screen2GraphCoords(state, x, y) {\n      var t = zoomTransform(state.canvas);\n      return {\n        x: (x - t.x) / t.k,\n        y: (y - t.y) / t.k\n      };\n    },\n    centerAt: function centerAt(state, x, y, transitionDuration) {\n      if (!state.canvas) return null; // no canvas yet\n\n      // setter\n      if (x !== undefined || y !== undefined) {\n        var finalPos = Object.assign({}, x !== undefined ? {\n          x: x\n        } : {}, y !== undefined ? {\n          y: y\n        } : {});\n        if (!transitionDuration) {\n          // no animation\n          setCenter(finalPos);\n        } else {\n          state.tweenGroup.add(new Tween(getCenter()).to(finalPos, transitionDuration).easing(Easing.Quadratic.Out).onUpdate(setCenter).start());\n        }\n        return this;\n      }\n\n      // getter\n      return getCenter();\n\n      //\n\n      function getCenter() {\n        var t = zoomTransform(state.canvas);\n        return {\n          x: (state.width / 2 - t.x) / t.k,\n          y: (state.height / 2 - t.y) / t.k\n        };\n      }\n      function setCenter(_ref5) {\n        var x = _ref5.x,\n          y = _ref5.y;\n        state.zoom.translateTo(state.zoom.__baseElem, x === undefined ? getCenter().x : x, y === undefined ? getCenter().y : y);\n        state.needsRedraw = true;\n      }\n    },\n    zoom: function zoom(state, k, transitionDuration) {\n      if (!state.canvas) return null; // no canvas yet\n\n      // setter\n      if (k !== undefined) {\n        if (!transitionDuration) {\n          // no animation\n          setZoom(k);\n        } else {\n          state.tweenGroup.add(new Tween({\n            k: getZoom()\n          }).to({\n            k: k\n          }, transitionDuration).easing(Easing.Quadratic.Out).onUpdate(function (_ref6) {\n            var k = _ref6.k;\n            return setZoom(k);\n          }).start());\n        }\n        return this;\n      }\n\n      // getter\n      return getZoom();\n\n      //\n\n      function getZoom() {\n        return zoomTransform(state.canvas).k;\n      }\n      function setZoom(k) {\n        state.zoom.scaleTo(state.zoom.__baseElem, k);\n        state.needsRedraw = true;\n      }\n    },\n    zoomToFit: function zoomToFit(state) {\n      var transitionDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var padding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10;\n      for (var _len = arguments.length, bboxArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n        bboxArgs[_key - 3] = arguments[_key];\n      }\n      var bbox = this.getGraphBbox.apply(this, bboxArgs);\n      if (bbox) {\n        var center = {\n          x: (bbox.x[0] + bbox.x[1]) / 2,\n          y: (bbox.y[0] + bbox.y[1]) / 2\n        };\n        var zoomK = Math.max(1e-12, Math.min(1e12, (state.width - padding * 2) / (bbox.x[1] - bbox.x[0]), (state.height - padding * 2) / (bbox.y[1] - bbox.y[0])));\n        this.centerAt(center.x, center.y, transitionDuration);\n        this.zoom(zoomK, transitionDuration);\n      }\n      return this;\n    },\n    getGraphBbox: function getGraphBbox(state) {\n      var nodeFilter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {\n        return true;\n      };\n      var getVal = accessorFn(state.nodeVal);\n      var getR = function getR(node) {\n        return Math.sqrt(Math.max(0, getVal(node) || 1)) * state.nodeRelSize;\n      };\n      var nodesPos = state.graphData.nodes.filter(nodeFilter).map(function (node) {\n        return {\n          x: node.x,\n          y: node.y,\n          r: getR(node)\n        };\n      });\n      return !nodesPos.length ? null : {\n        x: [min(nodesPos, function (node) {\n          return node.x - node.r;\n        }), max(nodesPos, function (node) {\n          return node.x + node.r;\n        })],\n        y: [min(nodesPos, function (node) {\n          return node.y - node.r;\n        }), max(nodesPos, function (node) {\n          return node.y + node.r;\n        })]\n      };\n    },\n    pauseAnimation: function pauseAnimation(state) {\n      if (state.animationFrameRequestId) {\n        cancelAnimationFrame(state.animationFrameRequestId);\n        state.animationFrameRequestId = null;\n      }\n      return this;\n    },\n    resumeAnimation: function resumeAnimation(state) {\n      if (!state.animationFrameRequestId) {\n        this._animationCycle();\n      }\n      return this;\n    },\n    _destructor: function _destructor() {\n      this.pauseAnimation();\n      this.graphData({\n        nodes: [],\n        links: []\n      });\n    }\n  }, linkedMethods),\n  stateInit: function stateInit() {\n    return {\n      lastSetZoom: 1,\n      zoom: zoom(),\n      forceGraph: new CanvasForceGraph(),\n      shadowGraph: new CanvasForceGraph().cooldownTicks(0).nodeColor('__indexColor').linkColor('__indexColor').isShadow(true),\n      colorTracker: new ColorTracker(),\n      // indexed objects for rgb lookup\n      tweenGroup: new Group()\n    };\n  },\n  init: function init(domNode, state) {\n    var _this = this;\n    // Wipe DOM\n    domNode.innerHTML = '';\n\n    // Container anchor for canvas and tooltip\n    var container = document.createElement('div');\n    container.classList.add('force-graph-container');\n    container.style.position = 'relative';\n    domNode.appendChild(container);\n    state.canvas = document.createElement('canvas');\n    if (state.backgroundColor) state.canvas.style.background = state.backgroundColor;\n    container.appendChild(state.canvas);\n    state.shadowCanvas = document.createElement('canvas');\n\n    // Show shadow canvas\n    //state.shadowCanvas.style.position = 'absolute';\n    //state.shadowCanvas.style.top = '0';\n    //state.shadowCanvas.style.left = '0';\n    //container.appendChild(state.shadowCanvas);\n\n    var ctx = state.canvas.getContext('2d');\n    var shadowCtx = state.shadowCanvas.getContext('2d', {\n      willReadFrequently: true\n    });\n    var pointerPos = {\n      x: -1e12,\n      y: -1e12\n    };\n    var getObjUnderPointer = function getObjUnderPointer() {\n      var obj = null;\n      var pxScale = window.devicePixelRatio;\n      var px = pointerPos.x > 0 && pointerPos.y > 0 ? shadowCtx.getImageData(pointerPos.x * pxScale, pointerPos.y * pxScale, 1, 1) : null;\n      // Lookup object per pixel color\n      px && (obj = state.colorTracker.lookup(px.data));\n      return obj;\n    };\n\n    // Setup node drag interaction\n    select(state.canvas).call(drag().subject(function () {\n      if (!state.enableNodeDrag) {\n        return null;\n      }\n      var obj = getObjUnderPointer();\n      return obj && obj.type === 'Node' ? obj.d : null; // Only drag nodes\n    }).on('start', function (ev) {\n      var obj = ev.subject;\n      obj.__initialDragPos = {\n        x: obj.x,\n        y: obj.y,\n        fx: obj.fx,\n        fy: obj.fy\n      };\n\n      // keep engine running at low intensity throughout drag\n      if (!ev.active) {\n        obj.fx = obj.x;\n        obj.fy = obj.y; // Fix points\n      }\n\n      // drag cursor\n      state.canvas.classList.add('grabbable');\n    }).on('drag', function (ev) {\n      var obj = ev.subject;\n      var initPos = obj.__initialDragPos;\n      var dragPos = ev;\n      var k = zoomTransform(state.canvas).k;\n      var translate = {\n        x: initPos.x + (dragPos.x - initPos.x) / k - obj.x,\n        y: initPos.y + (dragPos.y - initPos.y) / k - obj.y\n      };\n\n      // Move fx/fy (and x/y) of nodes based on the scaled drag distance since the drag start\n      ['x', 'y'].forEach(function (c) {\n        return obj[\"f\".concat(c)] = obj[c] = initPos[c] + (dragPos[c] - initPos[c]) / k;\n      });\n\n      // Only engage full drag if distance reaches above threshold\n      if (!obj.__dragged && DRAG_CLICK_TOLERANCE_PX >= Math.sqrt(sum(['x', 'y'].map(function (k) {\n        return Math.pow(ev[k] - initPos[k], 2);\n      })))) return;\n      state.forceGraph.d3AlphaTarget(0.3) // keep engine running at low intensity throughout drag\n      .resetCountdown(); // prevent freeze while dragging\n\n      state.isPointerDragging = true;\n      obj.__dragged = true;\n      state.onNodeDrag(obj, translate);\n    }).on('end', function (ev) {\n      var obj = ev.subject;\n      var initPos = obj.__initialDragPos;\n      var translate = {\n        x: obj.x - initPos.x,\n        y: obj.y - initPos.y\n      };\n      if (initPos.fx === undefined) {\n        obj.fx = undefined;\n      }\n      if (initPos.fy === undefined) {\n        obj.fy = undefined;\n      }\n      delete obj.__initialDragPos;\n      if (state.forceGraph.d3AlphaTarget()) {\n        state.forceGraph.d3AlphaTarget(0) // release engine low intensity\n        .resetCountdown(); // let the engine readjust after releasing fixed nodes\n      }\n\n      // drag cursor\n      state.canvas.classList.remove('grabbable');\n      state.isPointerDragging = false;\n      if (obj.__dragged) {\n        delete obj.__dragged;\n        state.onNodeDragEnd(obj, translate);\n      }\n    }));\n\n    // Setup zoom / pan interaction\n    state.zoom(state.zoom.__baseElem = select(state.canvas)); // Attach controlling elem for easy access\n\n    state.zoom.__baseElem.on('dblclick.zoom', null); // Disable double-click to zoom\n\n    state.zoom.filter(function (ev) {\n      return (\n        // disable zoom interaction\n        !ev.button && state.enableZoomPanInteraction && (ev.type !== 'wheel' || accessorFn(state.enableZoomInteraction)(ev)) && (ev.type === 'wheel' || accessorFn(state.enablePanInteraction)(ev))\n      );\n    }).on('zoom', function (ev) {\n      var t = ev.transform;\n      [ctx, shadowCtx].forEach(function (c) {\n        resetTransform(c);\n        c.translate(t.x, t.y);\n        c.scale(t.k, t.k);\n      });\n      state.isPointerDragging = true;\n      state.onZoom && state.onZoom(_objectSpread2(_objectSpread2({}, t), _this.centerAt())); // report x,y coordinates relative to canvas center\n      state.needsRedraw = true;\n    }).on('end', function (ev) {\n      state.isPointerDragging = false;\n      state.onZoomEnd && state.onZoomEnd(_objectSpread2(_objectSpread2({}, ev.transform), _this.centerAt()));\n    });\n    adjustCanvasSize(state);\n    state.forceGraph.onNeedsRedraw(function () {\n      return state.needsRedraw = true;\n    }).onFinishUpdate(function () {\n      // re-zoom, if still in default position (not user modified)\n      if (zoomTransform(state.canvas).k === state.lastSetZoom && state.graphData.nodes.length) {\n        state.zoom.scaleTo(state.zoom.__baseElem, state.lastSetZoom = ZOOM2NODES_FACTOR / Math.cbrt(state.graphData.nodes.length));\n        state.needsRedraw = true;\n      }\n    });\n\n    // Setup tooltip\n    state.tooltip = new Tooltip(container);\n\n    // Capture pointer coords on move or touchstart\n    ['pointermove', 'pointerdown'].forEach(function (evType) {\n      return container.addEventListener(evType, function (ev) {\n        if (evType === 'pointerdown') {\n          state.isPointerPressed = true; // track click state\n          state.pointerDownEvent = ev;\n        }\n\n        // detect pointer drag on canvas pan\n        !state.isPointerDragging && ev.type === 'pointermove' && state.onBackgroundClick // only bother detecting drags this way if background clicks are enabled (so they don't trigger accidentally on canvas panning)\n        && (ev.pressure > 0 || state.isPointerPressed) // ev.pressure always 0 on Safari, so we use the isPointerPressed tracker\n        && (ev.pointerType === 'mouse' || ev.movementX === undefined || [ev.movementX, ev.movementY].some(function (m) {\n          return Math.abs(m) > 1;\n        })) // relax drag trigger sensitivity on non-mouse (touch/pen) events\n        && (state.isPointerDragging = true);\n\n        // update the pointer pos\n        var offset = getOffset(container);\n        pointerPos.x = ev.pageX - offset.left;\n        pointerPos.y = ev.pageY - offset.top;\n\n        //\n\n        function getOffset(el) {\n          var rect = el.getBoundingClientRect(),\n            scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,\n            scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n          return {\n            top: rect.top + scrollTop,\n            left: rect.left + scrollLeft\n          };\n        }\n      }, {\n        passive: true\n      });\n    });\n\n    // Handle click/touch events on nodes/links\n    container.addEventListener('pointerup', function (ev) {\n      if (!state.isPointerPressed) {\n        return; // don't trigger click events if pointer is not pressed on the canvas\n      }\n      state.isPointerPressed = false;\n      if (state.isPointerDragging) {\n        state.isPointerDragging = false;\n        return; // don't trigger click events after pointer drag (pan / node drag functionality)\n      }\n      var cbEvents = [ev, state.pointerDownEvent];\n      requestAnimationFrame(function () {\n        // trigger click events asynchronously, to allow hoverObj to be set (on frame)\n        if (ev.button === 0) {\n          // mouse left-click or touch\n          if (state.hoverObj) {\n            var fn = state[\"on\".concat(state.hoverObj.type, \"Click\")];\n            fn && fn.apply(void 0, [state.hoverObj.d].concat(cbEvents));\n          } else {\n            state.onBackgroundClick && state.onBackgroundClick.apply(state, cbEvents);\n          }\n        }\n        if (ev.button === 2) {\n          // mouse right-click\n          if (state.hoverObj) {\n            var _fn = state[\"on\".concat(state.hoverObj.type, \"RightClick\")];\n            _fn && _fn.apply(void 0, [state.hoverObj.d].concat(cbEvents));\n          } else {\n            state.onBackgroundRightClick && state.onBackgroundRightClick.apply(state, cbEvents);\n          }\n        }\n      });\n    }, {\n      passive: true\n    });\n    container.addEventListener('contextmenu', function (ev) {\n      if (!state.onBackgroundRightClick && !state.onNodeRightClick && !state.onLinkRightClick) return true; // default contextmenu behavior\n      ev.preventDefault();\n      return false;\n    });\n    state.forceGraph(ctx);\n    state.shadowGraph(shadowCtx);\n\n    //\n\n    var refreshShadowCanvas = throttle(function () {\n      // wipe canvas\n      clearCanvas(shadowCtx, state.width, state.height);\n\n      // Adjust link hover area\n      state.shadowGraph.linkWidth(function (l) {\n        return accessorFn(state.linkWidth)(l) + state.linkHoverPrecision;\n      });\n\n      // redraw\n      var t = zoomTransform(state.canvas);\n      state.shadowGraph.globalScale(t.k).tickFrame();\n    }, HOVER_CANVAS_THROTTLE_DELAY);\n    state.flushShadowCanvas = refreshShadowCanvas.flush; // hook to immediately invoke shadow canvas paint\n\n    // Kick-off renderer\n    (this._animationCycle = function animate() {\n      // IIFE\n      var doRedraw = !state.autoPauseRedraw || !!state.needsRedraw || state.forceGraph.isEngineRunning() || state.graphData.links.some(function (d) {\n        return d.__photons && d.__photons.length;\n      });\n      state.needsRedraw = false;\n      if (state.enablePointerInteraction) {\n        // Update tooltip and trigger onHover events\n        var obj = !state.isPointerDragging ? getObjUnderPointer() : null; // don't hover during drag\n        if (obj !== state.hoverObj) {\n          var prevObj = state.hoverObj;\n          var prevObjType = prevObj ? prevObj.type : null;\n          var objType = obj ? obj.type : null;\n          if (prevObjType && prevObjType !== objType) {\n            // Hover out\n            var fn = state[\"on\".concat(prevObjType, \"Hover\")];\n            fn && fn(null, prevObj.d);\n          }\n          if (objType) {\n            // Hover in\n            var _fn2 = state[\"on\".concat(objType, \"Hover\")];\n            _fn2 && _fn2(obj.d, prevObjType === objType ? prevObj.d : null);\n          }\n          state.tooltip.content(obj ? accessorFn(state[\"\".concat(obj.type.toLowerCase(), \"Label\")])(obj.d) || null : null);\n\n          // set pointer if hovered object is clickable\n          state.canvas.classList[obj && state[\"on\".concat(objType, \"Click\")] || !obj && state.onBackgroundClick ? 'add' : 'remove']('clickable');\n          state.hoverObj = obj;\n        }\n        doRedraw && refreshShadowCanvas();\n      }\n      if (doRedraw) {\n        // Wipe canvas\n        clearCanvas(ctx, state.width, state.height);\n\n        // Frame cycle\n        var globalScale = zoomTransform(state.canvas).k;\n        state.onRenderFramePre && state.onRenderFramePre(ctx, globalScale);\n        state.forceGraph.globalScale(globalScale).tickFrame();\n        state.onRenderFramePost && state.onRenderFramePost(ctx, globalScale);\n      }\n      state.tweenGroup.update(); // update canvas animation tweens\n\n      state.animationFrameRequestId = requestAnimationFrame(animate);\n    })();\n  },\n  update: function updateFn(state) {}\n});\nexport { forceGraph as default };","map":{"version":3,"names":["select","zoomTransform","zoom","drag","sum","min","max","throttle","Group","Tween","Easing","Kapsule","accessorFn","ColorTracker","Tooltip","forceRadial","forceSimulation","forceLink","forceManyBody","forceCenter","Bezier","indexBy","scaleOrdinal","schemePaired","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","css_248z","_arrayLikeToArray","r","a","length","e","n","Array","_arrayWithHoles","isArray","_arrayWithoutHoles","_construct","t","_isNativeReflectConstruct","Reflect","construct","apply","arguments","o","push","p","bind","_defineProperty","_toPropertyKey","Object","defineProperty","value","enumerable","configurable","writable","Boolean","prototype","valueOf","call","_iterableToArray","Symbol","iterator","from","_iterableToArrayLimit","l","i","u","f","next","done","return","_nonIterableRest","TypeError","_nonIterableSpread","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","_objectSpread2","forEach","getOwnPropertyDescriptors","defineProperties","_slicedToArray","_unsupportedIterableToArray","_toConsumableArray","_toPrimitive","toPrimitive","String","Number","_typeof","constructor","toString","slice","name","test","autoColorScale","autoColorObjects","objects","colorByAccessor","colorField","obj","getDagDepths","_ref","idAccessor","nodes","links","_ref2","undefined","_ref2$nodeFilter","nodeFilter","_ref2$onLoopError","onLoopError","loopIds","concat","join","graph","node","data","out","depth","skip","_ref3","source","target","sourceId","getNodeId","targetId","hasOwnProperty","sourceNode","targetNode","foundLoops","traverse","values","nodeDepths","assign","entries","_ref4","_ref5","map","_ref6","_ref7","id","nodeStack","currentDepth","_loop","indexOf","loop","d","some","foundLoop","every","idx","DAG_LEVEL_NODE_RATIO","notifyRedraw","_","state","onNeedsRedraw","updDataPhotons","isShadow","linkParticlesAccessor","linkDirectionalParticles","graphData","link","numPhotons","Math","round","abs","__photons","CanvasForceGraph","props","onChange","engineRunning","dagMode","fx","fy","dagLevelDistance","dagNodeFilter","_default","onDagError","triggerUpdate","nodeRelSize","nodeId","nodeVal","nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","nodeVisibility","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCurvature","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticleSpeed","linkDirectionalParticleOffset","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleCanvasObject","globalScale","d3AlphaMin","d3AlphaDecay","alphaDecay","forceLayout","d3AlphaTarget","alphaTarget","d3VelocityDecay","velocityDecay","warmupTicks","cooldownTicks","Infinity","cooldownTime","onUpdate","onFinishUpdate","onEngineTick","onEngineStop","methods","d3Force","forceName","forceFn","force","d3ReheatSimulation","alpha","resetCountdown","cntTicks","startTickTime","Date","isEngineRunning","tickFrame","layoutTick","paintLinks","paintArrows","paintPhotons","paintNodes","tick","getVisibility","getVal","getColor","getNodeCanvasObjectMode","ctx","padAmount","visibleNodes","save","restore","sqrt","beginPath","arc","x","y","PI","fillStyle","fill","getWidth","getLineDash","getCurvature","getLinkCanvasObjectMode","visibleLinks","calcLinkControlPoints","beforeCustomLinks","afterCustomLinks","defaultPaintLinks","replaceCustomLinks","otherCustomLinks","before","after","replace","linksPerColor","color","linksPerWidth","lineColor","width","linesPerLineDash","lineWidth","lineDashSegments","start","end","moveTo","controlPoints","__controlPoints","lineTo","strokeStyle","setLineDash","stroke","curvature","pow","atan2","cp","cos","sin","_d","ARROW_WH_RATIO","ARROW_VLEN_RATIO","getLength","getRelPos","getNodeVal","arrowLength","startR","endR","arrowRelPos","arrowColor","arrowHalfWidth","bzLine","getCoordsAlongLine","get","lineLen","posAlongLine","arrowHead","arrowTail","arrowTailVertex","arrowTailAngle","getNumPhotons","getSpeed","getOffset","getDiameter","numCyclePhotons","particleSpeed","particleOffset","photons","photonR","photonColor","cyclePhotonIdx","needsCleanup","photon","singleHop","__singleHop","__progressRatio","photonPosRatio","coords","emitParticle","stateInit","stop","init","canvasCtx","update","changedProps","linkForce","maxDepth","includes","resetProp","invert","fixFn","_resetProp","nodeDepth","strength","linkKapsule","kapsulePropNames","kapsuleType","propNames","dummyK","_destructor","linkProp","prop","v","propName","linkMethod","method","_len","args","_key","returnVals","kapsuleInstance","returnVal","HOVER_CANVAS_THROTTLE_DELAY","ZOOM2NODES_FACTOR","DRAG_CLICK_TOLERANCE_PX","bindFG","bindBoth","linkedProps","linkedMethods","adjustCanvasSize","canvas","curWidth","curHeight","height","pxScale","window","devicePixelRatio","shadowCanvas","getContext","scale","k","translateBy","__baseElem","needsRedraw","resetTransform","pxRatio","setTransform","clearCanvas","clearRect","forceGraph","innerWidth","innerHeight","arr","colorTracker","reset","objs","hexIndex","shadowGraph","cur","lookup","__indexColor","register","backgroundColor","background","nodeLabel","nodePointerAreaPaint","paintFn","flushShadowCanvas","linkPointerAreaPaint","linkLabel","linkHoverPrecision","minZoom","scaleExtent","maxZoom","enableNodeDrag","enableZoomInteraction","enablePanInteraction","enableZoomPanInteraction","enablePointerInteraction","hoverObj","autoPauseRedraw","onNodeDrag","onNodeDragEnd","onNodeClick","onNodeRightClick","onNodeHover","onLinkClick","onLinkRightClick","onLinkHover","onBackgroundClick","onBackgroundRightClick","onZoom","onZoomEnd","onRenderFramePre","onRenderFramePost","aliases","stopAnimation","graph2ScreenCoords","screen2GraphCoords","centerAt","transitionDuration","finalPos","setCenter","tweenGroup","add","getCenter","to","easing","Quadratic","Out","translateTo","setZoom","getZoom","scaleTo","zoomToFit","padding","bboxArgs","bbox","getGraphBbox","center","zoomK","getR","nodesPos","pauseAnimation","animationFrameRequestId","cancelAnimationFrame","resumeAnimation","_animationCycle","lastSetZoom","domNode","_this","innerHTML","container","classList","position","shadowCtx","willReadFrequently","pointerPos","getObjUnderPointer","px","getImageData","subject","on","ev","__initialDragPos","active","initPos","dragPos","translate","c","__dragged","isPointerDragging","remove","button","transform","cbrt","tooltip","evType","addEventListener","isPointerPressed","pointerDownEvent","pressure","pointerType","movementX","movementY","m","offset","pageX","left","pageY","top","el","rect","getBoundingClientRect","scrollLeft","pageXOffset","documentElement","scrollTop","pageYOffset","passive","cbEvents","requestAnimationFrame","fn","_fn","preventDefault","refreshShadowCanvas","flush","animate","doRedraw","prevObj","prevObjType","objType","_fn2","content","toLowerCase","updateFn","default"],"sources":["C:/Users/sahan/Desktop/radheradhe/FraudShield/frontend/node_modules/force-graph/dist/force-graph.mjs"],"sourcesContent":["import { select } from 'd3-selection';\nimport { zoomTransform, zoom } from 'd3-zoom';\nimport { drag } from 'd3-drag';\nimport { sum, min, max } from 'd3-array';\nimport { throttle } from 'lodash-es';\nimport { Group, Tween, Easing } from '@tweenjs/tween.js';\nimport Kapsule from 'kapsule';\nimport accessorFn from 'accessor-fn';\nimport ColorTracker from 'canvas-color-tracker';\nimport Tooltip from 'float-tooltip';\nimport { forceRadial, forceSimulation, forceLink, forceManyBody, forceCenter } from 'd3-force-3d';\nimport { Bezier } from 'bezier-js';\nimport indexBy from 'index-array-by';\nimport { scaleOrdinal } from 'd3-scale';\nimport { schemePaired } from 'd3-scale-chromatic';\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n  if (typeof document === 'undefined') {\n    return;\n  }\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".force-graph-container canvas {\\n  display: block;\\n  user-select: none;\\n  outline: none;\\n  -webkit-tap-highlight-color: transparent;\\n}\\n\\n.force-graph-container .clickable {\\n  cursor: pointer;\\n}\\n\\n.force-graph-container .grabbable {\\n  cursor: move;\\n  cursor: grab;\\n  cursor: -moz-grab;\\n  cursor: -webkit-grab;\\n}\\n\\n.force-graph-container .grabbable:active {\\n  cursor: grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: -webkit-grabbing;\\n}\\n\";\nstyleInject(css_248z);\n\nfunction _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nfunction _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return _arrayLikeToArray(r);\n}\nfunction _construct(t, e, r) {\n  if (_isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments);\n  var o = [null];\n  o.push.apply(o, e);\n  var p = new (t.bind.apply(t, o))();\n  return p;\n}\nfunction _defineProperty(e, r, t) {\n  return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: true,\n    configurable: true,\n    writable: true\n  }) : e[r] = t, e;\n}\nfunction _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (_isNativeReflectConstruct = function () {\n    return !!t;\n  })();\n}\nfunction _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nfunction _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = true,\n      o = false;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) ; else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = true, n = r;\n    } finally {\n      try {\n        if (!f && null != t.return && (u = t.return(), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), true).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nfunction _slicedToArray(r, e) {\n  return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest();\n}\nfunction _toConsumableArray(r) {\n  return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread();\n}\nfunction _toPrimitive(t, r) {\n  if (\"object\" != typeof t || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r);\n    if (\"object\" != typeof i) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nfunction _toPropertyKey(t) {\n  var i = _toPrimitive(t, \"string\");\n  return \"symbol\" == typeof i ? i : i + \"\";\n}\nfunction _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return _arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0;\n  }\n}\n\nvar autoColorScale = scaleOrdinal(schemePaired);\n\n// Autoset attribute colorField by colorByAccessor property\n// If an object has already a color, don't set it\n// Objects can be nodes or links\nfunction autoColorObjects(objects, colorByAccessor, colorField) {\n  if (!colorByAccessor || typeof colorField !== 'string') return;\n  objects.filter(function (obj) {\n    return !obj[colorField];\n  }).forEach(function (obj) {\n    obj[colorField] = autoColorScale(colorByAccessor(obj));\n  });\n}\n\nfunction getDagDepths (_ref, idAccessor) {\n  var nodes = _ref.nodes,\n    links = _ref.links;\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n    _ref2$nodeFilter = _ref2.nodeFilter,\n    nodeFilter = _ref2$nodeFilter === void 0 ? function () {\n      return true;\n    } : _ref2$nodeFilter,\n    _ref2$onLoopError = _ref2.onLoopError,\n    onLoopError = _ref2$onLoopError === void 0 ? function (loopIds) {\n      throw \"Invalid DAG structure! Found cycle in node path: \".concat(loopIds.join(' -> '), \".\");\n    } : _ref2$onLoopError;\n  // linked graph\n  var graph = {};\n  nodes.forEach(function (node) {\n    return graph[idAccessor(node)] = {\n      data: node,\n      out: [],\n      depth: -1,\n      skip: !nodeFilter(node)\n    };\n  });\n  links.forEach(function (_ref3) {\n    var source = _ref3.source,\n      target = _ref3.target;\n    var sourceId = getNodeId(source);\n    var targetId = getNodeId(target);\n    if (!graph.hasOwnProperty(sourceId)) throw \"Missing source node with id: \".concat(sourceId);\n    if (!graph.hasOwnProperty(targetId)) throw \"Missing target node with id: \".concat(targetId);\n    var sourceNode = graph[sourceId];\n    var targetNode = graph[targetId];\n    sourceNode.out.push(targetNode);\n    function getNodeId(node) {\n      return _typeof(node) === 'object' ? idAccessor(node) : node;\n    }\n  });\n  var foundLoops = [];\n  traverse(Object.values(graph));\n  var nodeDepths = Object.assign.apply(Object, [{}].concat(_toConsumableArray(Object.entries(graph).filter(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n      node = _ref5[1];\n    return !node.skip;\n  }).map(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n      id = _ref7[0],\n      node = _ref7[1];\n    return _defineProperty({}, id, node.depth);\n  }))));\n  return nodeDepths;\n  function traverse(nodes) {\n    var nodeStack = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var currentDepth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var _loop = function _loop() {\n      var node = nodes[i];\n      if (nodeStack.indexOf(node) !== -1) {\n        var loop = [].concat(_toConsumableArray(nodeStack.slice(nodeStack.indexOf(node))), [node]).map(function (d) {\n          return idAccessor(d.data);\n        });\n        if (!foundLoops.some(function (foundLoop) {\n          return foundLoop.length === loop.length && foundLoop.every(function (id, idx) {\n            return id === loop[idx];\n          });\n        })) {\n          foundLoops.push(loop);\n          onLoopError(loop);\n        }\n        return 1; // continue\n      }\n      if (currentDepth > node.depth) {\n        // Don't unnecessarily revisit chunks of the graph\n        node.depth = currentDepth;\n        traverse(node.out, [].concat(_toConsumableArray(nodeStack), [node]), currentDepth + (node.skip ? 0 : 1));\n      }\n    };\n    for (var i = 0, l = nodes.length; i < l; i++) {\n      if (_loop()) continue;\n    }\n  }\n}\n\n//\n\nvar DAG_LEVEL_NODE_RATIO = 2;\n\n// whenever styling props are changed that require a canvas redraw\nvar notifyRedraw = function notifyRedraw(_, state) {\n  return state.onNeedsRedraw && state.onNeedsRedraw();\n};\nvar updDataPhotons = function updDataPhotons(_, state) {\n  if (!state.isShadow) {\n    // Add photon particles\n    var linkParticlesAccessor = accessorFn(state.linkDirectionalParticles);\n    state.graphData.links.forEach(function (link) {\n      var numPhotons = Math.round(Math.abs(linkParticlesAccessor(link)));\n      if (numPhotons) {\n        link.__photons = _toConsumableArray(Array(numPhotons)).map(function () {\n          return {};\n        });\n      } else {\n        delete link.__photons;\n      }\n    });\n  }\n};\nvar CanvasForceGraph = Kapsule({\n  props: {\n    graphData: {\n      \"default\": {\n        nodes: [],\n        links: []\n      },\n      onChange: function onChange(_, state) {\n        state.engineRunning = false; // Pause simulation\n        updDataPhotons(_, state);\n      }\n    },\n    dagMode: {\n      onChange: function onChange(dagMode, state) {\n        // td, bu, lr, rl, radialin, radialout\n        !dagMode && (state.graphData.nodes || []).forEach(function (n) {\n          return n.fx = n.fy = undefined;\n        }); // unfix nodes when disabling dag mode\n      }\n    },\n    dagLevelDistance: {},\n    dagNodeFilter: {\n      \"default\": function _default(node) {\n        return true;\n      }\n    },\n    onDagError: {\n      triggerUpdate: false\n    },\n    nodeRelSize: {\n      \"default\": 4,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    // area per val unit\n    nodeId: {\n      \"default\": 'id'\n    },\n    nodeVal: {\n      \"default\": 'val',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeColor: {\n      \"default\": 'color',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeAutoColorBy: {},\n    nodeCanvasObject: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeCanvasObjectMode: {\n      \"default\": function _default() {\n        return 'replace';\n      },\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeVisibility: {\n      \"default\": true,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkSource: {\n      \"default\": 'source'\n    },\n    linkTarget: {\n      \"default\": 'target'\n    },\n    linkVisibility: {\n      \"default\": true,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkColor: {\n      \"default\": 'color',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkAutoColorBy: {},\n    linkLineDash: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkWidth: {\n      \"default\": 1,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCurvature: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCanvasObject: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCanvasObjectMode: {\n      \"default\": function _default() {\n        return 'replace';\n      },\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowLength: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowColor: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowRelPos: {\n      \"default\": 0.5,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    // value between 0<>1 indicating the relative pos along the (exposed) line\n    linkDirectionalParticles: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: updDataPhotons\n    },\n    // animate photons travelling in the link direction\n    linkDirectionalParticleSpeed: {\n      \"default\": 0.01,\n      triggerUpdate: false\n    },\n    // in link length ratio per frame\n    linkDirectionalParticleOffset: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    // starting position offset along the link's length, like a pre-delay. Values between [0, 1]\n    linkDirectionalParticleWidth: {\n      \"default\": 4,\n      triggerUpdate: false\n    },\n    linkDirectionalParticleColor: {\n      triggerUpdate: false\n    },\n    linkDirectionalParticleCanvasObject: {\n      triggerUpdate: false\n    },\n    globalScale: {\n      \"default\": 1,\n      triggerUpdate: false\n    },\n    d3AlphaMin: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    d3AlphaDecay: {\n      \"default\": 0.0228,\n      triggerUpdate: false,\n      onChange: function onChange(alphaDecay, state) {\n        state.forceLayout.alphaDecay(alphaDecay);\n      }\n    },\n    d3AlphaTarget: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: function onChange(alphaTarget, state) {\n        state.forceLayout.alphaTarget(alphaTarget);\n      }\n    },\n    d3VelocityDecay: {\n      \"default\": 0.4,\n      triggerUpdate: false,\n      onChange: function onChange(velocityDecay, state) {\n        state.forceLayout.velocityDecay(velocityDecay);\n      }\n    },\n    warmupTicks: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    // how many times to tick the force engine at init before starting to render\n    cooldownTicks: {\n      \"default\": Infinity,\n      triggerUpdate: false\n    },\n    cooldownTime: {\n      \"default\": 15000,\n      triggerUpdate: false\n    },\n    // ms\n    onUpdate: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onFinishUpdate: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onEngineTick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onEngineStop: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNeedsRedraw: {\n      triggerUpdate: false\n    },\n    isShadow: {\n      \"default\": false,\n      triggerUpdate: false\n    }\n  },\n  methods: {\n    // Expose d3 forces for external manipulation\n    d3Force: function d3Force(state, forceName, forceFn) {\n      if (forceFn === undefined) {\n        return state.forceLayout.force(forceName); // Force getter\n      }\n      state.forceLayout.force(forceName, forceFn); // Force setter\n      return this;\n    },\n    d3ReheatSimulation: function d3ReheatSimulation(state) {\n      state.forceLayout.alpha(1);\n      this.resetCountdown();\n      return this;\n    },\n    // reset cooldown state\n    resetCountdown: function resetCountdown(state) {\n      state.cntTicks = 0;\n      state.startTickTime = new Date();\n      state.engineRunning = true;\n      return this;\n    },\n    isEngineRunning: function isEngineRunning(state) {\n      return !!state.engineRunning;\n    },\n    tickFrame: function tickFrame(state) {\n      !state.isShadow && layoutTick();\n      paintLinks();\n      !state.isShadow && paintArrows();\n      !state.isShadow && paintPhotons();\n      paintNodes();\n      return this;\n\n      //\n\n      function layoutTick() {\n        if (state.engineRunning) {\n          if (++state.cntTicks > state.cooldownTicks || new Date() - state.startTickTime > state.cooldownTime || state.d3AlphaMin > 0 && state.forceLayout.alpha() < state.d3AlphaMin) {\n            state.engineRunning = false; // Stop ticking graph\n            state.onEngineStop();\n          } else {\n            state.forceLayout.tick(); // Tick it\n            state.onEngineTick();\n          }\n        }\n      }\n      function paintNodes() {\n        var getVisibility = accessorFn(state.nodeVisibility);\n        var getVal = accessorFn(state.nodeVal);\n        var getColor = accessorFn(state.nodeColor);\n        var getNodeCanvasObjectMode = accessorFn(state.nodeCanvasObjectMode);\n        var ctx = state.ctx;\n\n        // Draw wider nodes by 1px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n        var padAmount = state.isShadow / state.globalScale;\n        var visibleNodes = state.graphData.nodes.filter(getVisibility);\n        ctx.save();\n        visibleNodes.forEach(function (node) {\n          var nodeCanvasObjectMode = getNodeCanvasObjectMode(node);\n          if (state.nodeCanvasObject && (nodeCanvasObjectMode === 'before' || nodeCanvasObjectMode === 'replace')) {\n            // Custom node before/replace paint\n            state.nodeCanvasObject(node, ctx, state.globalScale);\n            if (nodeCanvasObjectMode === 'replace') {\n              ctx.restore();\n              return;\n            }\n          }\n\n          // Draw wider nodes by 1px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n          var r = Math.sqrt(Math.max(0, getVal(node) || 1)) * state.nodeRelSize + padAmount;\n          ctx.beginPath();\n          ctx.arc(node.x, node.y, r, 0, 2 * Math.PI, false);\n          ctx.fillStyle = getColor(node) || 'rgba(31, 120, 180, 0.92)';\n          ctx.fill();\n          if (state.nodeCanvasObject && nodeCanvasObjectMode === 'after') {\n            // Custom node after paint\n            state.nodeCanvasObject(node, state.ctx, state.globalScale);\n          }\n        });\n        ctx.restore();\n      }\n      function paintLinks() {\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkColor);\n        var getWidth = accessorFn(state.linkWidth);\n        var getLineDash = accessorFn(state.linkLineDash);\n        var getCurvature = accessorFn(state.linkCurvature);\n        var getLinkCanvasObjectMode = accessorFn(state.linkCanvasObjectMode);\n        var ctx = state.ctx;\n\n        // Draw wider lines by 2px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n        var padAmount = state.isShadow * 2;\n        var visibleLinks = state.graphData.links.filter(getVisibility);\n        visibleLinks.forEach(calcLinkControlPoints); // calculate curvature control points for all visible links\n\n        var beforeCustomLinks = [],\n          afterCustomLinks = [],\n          defaultPaintLinks = visibleLinks;\n        if (state.linkCanvasObject) {\n          var replaceCustomLinks = [],\n            otherCustomLinks = [];\n          visibleLinks.forEach(function (d) {\n            return ({\n              before: beforeCustomLinks,\n              after: afterCustomLinks,\n              replace: replaceCustomLinks\n            }[getLinkCanvasObjectMode(d)] || otherCustomLinks).push(d);\n          });\n          defaultPaintLinks = [].concat(_toConsumableArray(beforeCustomLinks), afterCustomLinks, otherCustomLinks);\n          beforeCustomLinks = beforeCustomLinks.concat(replaceCustomLinks);\n        }\n\n        // Custom link before paints\n        ctx.save();\n        beforeCustomLinks.forEach(function (link) {\n          return state.linkCanvasObject(link, ctx, state.globalScale);\n        });\n        ctx.restore();\n\n        // Bundle strokes per unique color/width/dash for performance optimization\n        var linksPerColor = indexBy(defaultPaintLinks, [getColor, getWidth, getLineDash]);\n        ctx.save();\n        Object.entries(linksPerColor).forEach(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n            color = _ref2[0],\n            linksPerWidth = _ref2[1];\n          var lineColor = !color || color === 'undefined' ? 'rgba(0,0,0,0.15)' : color;\n          Object.entries(linksPerWidth).forEach(function (_ref3) {\n            var _ref4 = _slicedToArray(_ref3, 2),\n              width = _ref4[0],\n              linesPerLineDash = _ref4[1];\n            var lineWidth = (width || 1) / state.globalScale + padAmount;\n            Object.entries(linesPerLineDash).forEach(function (_ref5) {\n              var _ref6 = _slicedToArray(_ref5, 2);\n                _ref6[0];\n                var links = _ref6[1];\n              var lineDashSegments = getLineDash(links[0]);\n              ctx.beginPath();\n              links.forEach(function (link) {\n                var start = link.source;\n                var end = link.target;\n                if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n                ctx.moveTo(start.x, start.y);\n                var controlPoints = link.__controlPoints;\n                if (!controlPoints) {\n                  // Straight line\n                  ctx.lineTo(end.x, end.y);\n                } else {\n                  // Use quadratic curves for regular lines and bezier for loops\n                  ctx[controlPoints.length === 2 ? 'quadraticCurveTo' : 'bezierCurveTo'].apply(ctx, _toConsumableArray(controlPoints).concat([end.x, end.y]));\n                }\n              });\n              ctx.strokeStyle = lineColor;\n              ctx.lineWidth = lineWidth;\n              ctx.setLineDash(lineDashSegments || []);\n              ctx.stroke();\n            });\n          });\n        });\n        ctx.restore();\n\n        // Custom link after paints\n        ctx.save();\n        afterCustomLinks.forEach(function (link) {\n          return state.linkCanvasObject(link, ctx, state.globalScale);\n        });\n        ctx.restore();\n\n        //\n\n        function calcLinkControlPoints(link) {\n          var curvature = getCurvature(link);\n          if (!curvature) {\n            // straight line\n            link.__controlPoints = null;\n            return;\n          }\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var l = Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2)); // line length\n\n          if (l > 0) {\n            var a = Math.atan2(end.y - start.y, end.x - start.x); // line angle\n            var d = l * curvature; // control point distance\n\n            var cp = {\n              // control point\n              x: (start.x + end.x) / 2 + d * Math.cos(a - Math.PI / 2),\n              y: (start.y + end.y) / 2 + d * Math.sin(a - Math.PI / 2)\n            };\n            link.__controlPoints = [cp.x, cp.y];\n          } else {\n            // Same point, draw a loop\n            var _d = curvature * 70;\n            link.__controlPoints = [end.x, end.y - _d, end.x + _d, end.y];\n          }\n        }\n      }\n      function paintArrows() {\n        var ARROW_WH_RATIO = 1.6;\n        var ARROW_VLEN_RATIO = 0.2;\n        var getLength = accessorFn(state.linkDirectionalArrowLength);\n        var getRelPos = accessorFn(state.linkDirectionalArrowRelPos);\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkDirectionalArrowColor || state.linkColor);\n        var getNodeVal = accessorFn(state.nodeVal);\n        var ctx = state.ctx;\n        ctx.save();\n        state.graphData.links.filter(getVisibility).forEach(function (link) {\n          var arrowLength = getLength(link);\n          if (!arrowLength || arrowLength < 0) return;\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var startR = Math.sqrt(Math.max(0, getNodeVal(start) || 1)) * state.nodeRelSize;\n          var endR = Math.sqrt(Math.max(0, getNodeVal(end) || 1)) * state.nodeRelSize;\n          var arrowRelPos = Math.min(1, Math.max(0, getRelPos(link)));\n          var arrowColor = getColor(link) || 'rgba(0,0,0,0.28)';\n          var arrowHalfWidth = arrowLength / ARROW_WH_RATIO / 2;\n\n          // Construct bezier for curved lines\n          var bzLine = link.__controlPoints && _construct(Bezier, [start.x, start.y].concat(_toConsumableArray(link.__controlPoints), [end.x, end.y]));\n          var getCoordsAlongLine = bzLine ? function (t) {\n            return bzLine.get(t);\n          } // get position along bezier line\n          : function (t) {\n            return {\n              // straight line: interpolate linearly\n              x: start.x + (end.x - start.x) * t || 0,\n              y: start.y + (end.y - start.y) * t || 0\n            };\n          };\n          var lineLen = bzLine ? bzLine.length() : Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2));\n          var posAlongLine = startR + arrowLength + (lineLen - startR - endR - arrowLength) * arrowRelPos;\n          var arrowHead = getCoordsAlongLine(posAlongLine / lineLen);\n          var arrowTail = getCoordsAlongLine((posAlongLine - arrowLength) / lineLen);\n          var arrowTailVertex = getCoordsAlongLine((posAlongLine - arrowLength * (1 - ARROW_VLEN_RATIO)) / lineLen);\n          var arrowTailAngle = Math.atan2(arrowHead.y - arrowTail.y, arrowHead.x - arrowTail.x) - Math.PI / 2;\n          ctx.beginPath();\n          ctx.moveTo(arrowHead.x, arrowHead.y);\n          ctx.lineTo(arrowTail.x + arrowHalfWidth * Math.cos(arrowTailAngle), arrowTail.y + arrowHalfWidth * Math.sin(arrowTailAngle));\n          ctx.lineTo(arrowTailVertex.x, arrowTailVertex.y);\n          ctx.lineTo(arrowTail.x - arrowHalfWidth * Math.cos(arrowTailAngle), arrowTail.y - arrowHalfWidth * Math.sin(arrowTailAngle));\n          ctx.fillStyle = arrowColor;\n          ctx.fill();\n        });\n        ctx.restore();\n      }\n      function paintPhotons() {\n        var getNumPhotons = accessorFn(state.linkDirectionalParticles);\n        var getSpeed = accessorFn(state.linkDirectionalParticleSpeed);\n        var getOffset = accessorFn(state.linkDirectionalParticleOffset);\n        var getDiameter = accessorFn(state.linkDirectionalParticleWidth);\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkDirectionalParticleColor || state.linkColor);\n        var ctx = state.ctx;\n        ctx.save();\n        state.graphData.links.filter(getVisibility).forEach(function (link) {\n          var numCyclePhotons = getNumPhotons(link);\n          if (!link.hasOwnProperty('__photons') || !link.__photons.length) return;\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var particleSpeed = getSpeed(link);\n          var particleOffset = Math.abs(getOffset(link));\n          var photons = link.__photons || [];\n          var photonR = Math.max(0, getDiameter(link) / 2) / Math.sqrt(state.globalScale);\n          var photonColor = getColor(link) || 'rgba(0,0,0,0.28)';\n          ctx.fillStyle = photonColor;\n\n          // Construct bezier for curved lines\n          var bzLine = link.__controlPoints ? _construct(Bezier, [start.x, start.y].concat(_toConsumableArray(link.__controlPoints), [end.x, end.y])) : null;\n          var cyclePhotonIdx = 0;\n          var needsCleanup = false; // whether some photons need to be removed from list\n          photons.forEach(function (photon) {\n            var singleHop = !!photon.__singleHop;\n            if (!photon.hasOwnProperty('__progressRatio')) {\n              photon.__progressRatio = singleHop ? 0 : (cyclePhotonIdx + particleOffset) / numCyclePhotons;\n            }\n            !singleHop && cyclePhotonIdx++; // increase regular photon index\n\n            photon.__progressRatio += particleSpeed;\n            if (photon.__progressRatio >= 1) {\n              if (!singleHop) {\n                photon.__progressRatio = photon.__progressRatio % 1;\n              } else {\n                needsCleanup = true;\n                return;\n              }\n            }\n            var photonPosRatio = photon.__progressRatio;\n            var coords = bzLine ? bzLine.get(photonPosRatio) // get position along bezier line\n            : {\n              // straight line: interpolate linearly\n              x: start.x + (end.x - start.x) * photonPosRatio || 0,\n              y: start.y + (end.y - start.y) * photonPosRatio || 0\n            };\n            if (state.linkDirectionalParticleCanvasObject) {\n              state.linkDirectionalParticleCanvasObject(coords.x, coords.y, link, ctx, state.globalScale);\n            } else {\n              ctx.beginPath();\n              ctx.arc(coords.x, coords.y, photonR, 0, 2 * Math.PI, false);\n              ctx.fill();\n            }\n          });\n          if (needsCleanup) {\n            // remove expired single hop photons\n            link.__photons = link.__photons.filter(function (photon) {\n              return !photon.__singleHop || photon.__progressRatio <= 1;\n            });\n          }\n        });\n        ctx.restore();\n      }\n    },\n    emitParticle: function emitParticle(state, link) {\n      if (link) {\n        !link.__photons && (link.__photons = []);\n        link.__photons.push({\n          __singleHop: true\n        }); // add a single hop particle\n      }\n      return this;\n    }\n  },\n  stateInit: function stateInit() {\n    return {\n      forceLayout: forceSimulation().force('link', forceLink()).force('charge', forceManyBody()).force('center', forceCenter()).force('dagRadial', null).stop(),\n      engineRunning: false\n    };\n  },\n  init: function init(canvasCtx, state) {\n    // Main canvas object to manipulate\n    state.ctx = canvasCtx;\n  },\n  update: function update(state, changedProps) {\n    state.engineRunning = false; // Pause simulation\n    state.onUpdate();\n    if (state.nodeAutoColorBy !== null) {\n      // Auto add color to uncolored nodes\n      autoColorObjects(state.graphData.nodes, accessorFn(state.nodeAutoColorBy), state.nodeColor);\n    }\n    if (state.linkAutoColorBy !== null) {\n      // Auto add color to uncolored links\n      autoColorObjects(state.graphData.links, accessorFn(state.linkAutoColorBy), state.linkColor);\n    }\n\n    // parse links\n    state.graphData.links.forEach(function (link) {\n      link.source = link[state.linkSource];\n      link.target = link[state.linkTarget];\n    });\n\n    // Feed data to force-directed layout\n    state.forceLayout.stop().alpha(1) // re-heat the simulation\n    .nodes(state.graphData.nodes);\n\n    // add links (if link force is still active)\n    var linkForce = state.forceLayout.force('link');\n    if (linkForce) {\n      linkForce.id(function (d) {\n        return d[state.nodeId];\n      }).links(state.graphData.links);\n    }\n\n    // setup dag force constraints\n    var nodeDepths = state.dagMode && getDagDepths(state.graphData, function (node) {\n      return node[state.nodeId];\n    }, {\n      nodeFilter: state.dagNodeFilter,\n      onLoopError: state.onDagError || undefined\n    });\n    var maxDepth = Math.max.apply(Math, _toConsumableArray(Object.values(nodeDepths || [])));\n    var dagLevelDistance = state.dagLevelDistance || state.graphData.nodes.length / (maxDepth || 1) * DAG_LEVEL_NODE_RATIO * (['radialin', 'radialout'].indexOf(state.dagMode) !== -1 ? 0.7 : 1);\n\n    // Reset relevant fx/fy when swapping dag modes\n    if (['lr', 'rl', 'td', 'bu'].includes(changedProps.dagMode)) {\n      var resetProp = ['lr', 'rl'].includes(changedProps.dagMode) ? 'fx' : 'fy';\n      state.graphData.nodes.filter(state.dagNodeFilter).forEach(function (node) {\n        return delete node[resetProp];\n      });\n    }\n\n    // Fix nodes to x,y for dag mode\n    if (['lr', 'rl', 'td', 'bu'].includes(state.dagMode)) {\n      var invert = ['rl', 'bu'].includes(state.dagMode);\n      var fixFn = function fixFn(node) {\n        return (nodeDepths[node[state.nodeId]] - maxDepth / 2) * dagLevelDistance * (invert ? -1 : 1);\n      };\n      var _resetProp = ['lr', 'rl'].includes(state.dagMode) ? 'fx' : 'fy';\n      state.graphData.nodes.filter(state.dagNodeFilter).forEach(function (node) {\n        return node[_resetProp] = fixFn(node);\n      });\n    }\n\n    // Use radial force for radial dags\n    state.forceLayout.force('dagRadial', ['radialin', 'radialout'].indexOf(state.dagMode) !== -1 ? forceRadial(function (node) {\n      var nodeDepth = nodeDepths[node[state.nodeId]] || -1;\n      return (state.dagMode === 'radialin' ? maxDepth - nodeDepth : nodeDepth) * dagLevelDistance;\n    }).strength(function (node) {\n      return state.dagNodeFilter(node) ? 1 : 0;\n    }) : null);\n    for (var i = 0; i < state.warmupTicks && !(state.d3AlphaMin > 0 && state.forceLayout.alpha() < state.d3AlphaMin); i++) {\n      state.forceLayout.tick();\n    } // Initial ticks before starting to render\n\n    this.resetCountdown();\n    state.onFinishUpdate();\n  }\n});\n\nfunction linkKapsule (kapsulePropNames, kapsuleType) {\n  var propNames = kapsulePropNames instanceof Array ? kapsulePropNames : [kapsulePropNames];\n  var dummyK = new kapsuleType(); // To extract defaults\n  dummyK._destructor && dummyK._destructor();\n  return {\n    linkProp: function linkProp(prop) {\n      // link property config\n      return {\n        \"default\": dummyK[prop](),\n        onChange: function onChange(v, state) {\n          propNames.forEach(function (propName) {\n            return state[propName][prop](v);\n          });\n        },\n        triggerUpdate: false\n      };\n    },\n    linkMethod: function linkMethod(method) {\n      // link method pass-through\n      return function (state) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n        var returnVals = [];\n        propNames.forEach(function (propName) {\n          var kapsuleInstance = state[propName];\n          var returnVal = kapsuleInstance[method].apply(kapsuleInstance, args);\n          if (returnVal !== kapsuleInstance) {\n            returnVals.push(returnVal);\n          }\n        });\n        return returnVals.length ? returnVals[0] : this; // chain based on the parent object, not the inner kapsule\n      };\n    }\n  };\n}\n\nvar HOVER_CANVAS_THROTTLE_DELAY = 800; // ms to throttle shadow canvas updates for perf improvement\nvar ZOOM2NODES_FACTOR = 4;\nvar DRAG_CLICK_TOLERANCE_PX = 5; // How many px can a node be accidentally dragged before disabling the click\n\n// Expose config from forceGraph\nvar bindFG = linkKapsule('forceGraph', CanvasForceGraph);\nvar bindBoth = linkKapsule(['forceGraph', 'shadowGraph'], CanvasForceGraph);\nvar linkedProps = Object.assign.apply(Object, _toConsumableArray(['nodeColor', 'nodeAutoColorBy', 'nodeCanvasObject', 'nodeCanvasObjectMode', 'linkColor', 'linkAutoColorBy', 'linkLineDash', 'linkWidth', 'linkCanvasObject', 'linkCanvasObjectMode', 'linkDirectionalArrowLength', 'linkDirectionalArrowColor', 'linkDirectionalArrowRelPos', 'linkDirectionalParticles', 'linkDirectionalParticleSpeed', 'linkDirectionalParticleOffset', 'linkDirectionalParticleWidth', 'linkDirectionalParticleColor', 'linkDirectionalParticleCanvasObject', 'dagMode', 'dagLevelDistance', 'dagNodeFilter', 'onDagError', 'd3AlphaMin', 'd3AlphaDecay', 'd3VelocityDecay', 'warmupTicks', 'cooldownTicks', 'cooldownTime', 'onEngineTick', 'onEngineStop'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkProp(p));\n})).concat(_toConsumableArray(['nodeRelSize', 'nodeId', 'nodeVal', 'nodeVisibility', 'linkSource', 'linkTarget', 'linkVisibility', 'linkCurvature'].map(function (p) {\n  return _defineProperty({}, p, bindBoth.linkProp(p));\n}))));\nvar linkedMethods = Object.assign.apply(Object, _toConsumableArray(['d3Force', 'd3ReheatSimulation', 'emitParticle'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkMethod(p));\n})));\nfunction adjustCanvasSize(state) {\n  if (state.canvas) {\n    var curWidth = state.canvas.width;\n    var curHeight = state.canvas.height;\n    if (curWidth === 300 && curHeight === 150) {\n      // Default canvas dimensions\n      curWidth = curHeight = 0;\n    }\n    var pxScale = window.devicePixelRatio; // 2 on retina displays\n    curWidth /= pxScale;\n    curHeight /= pxScale;\n\n    // Resize canvases\n    [state.canvas, state.shadowCanvas].forEach(function (canvas) {\n      // Element size\n      canvas.style.width = \"\".concat(state.width, \"px\");\n      canvas.style.height = \"\".concat(state.height, \"px\");\n\n      // Memory size (scaled to avoid blurriness)\n      canvas.width = state.width * pxScale;\n      canvas.height = state.height * pxScale;\n\n      // Normalize coordinate system to use css pixels (on init only)\n      if (!curWidth && !curHeight) {\n        canvas.getContext('2d').scale(pxScale, pxScale);\n      }\n    });\n\n    // Relative center panning based on 0,0\n    var k = zoomTransform(state.canvas).k;\n    state.zoom.translateBy(state.zoom.__baseElem, (state.width - curWidth) / 2 / k, (state.height - curHeight) / 2 / k);\n    state.needsRedraw = true;\n  }\n}\nfunction resetTransform(ctx) {\n  var pxRatio = window.devicePixelRatio;\n  ctx.setTransform(pxRatio, 0, 0, pxRatio, 0, 0);\n}\nfunction clearCanvas(ctx, width, height) {\n  ctx.save();\n  resetTransform(ctx); // reset transform\n  ctx.clearRect(0, 0, width, height);\n  ctx.restore(); //restore transforms\n}\n\n//\n\nvar forceGraph = Kapsule({\n  props: _objectSpread2({\n    width: {\n      \"default\": window.innerWidth,\n      onChange: function onChange(_, state) {\n        return adjustCanvasSize(state);\n      },\n      triggerUpdate: false\n    },\n    height: {\n      \"default\": window.innerHeight,\n      onChange: function onChange(_, state) {\n        return adjustCanvasSize(state);\n      },\n      triggerUpdate: false\n    },\n    graphData: {\n      \"default\": {\n        nodes: [],\n        links: []\n      },\n      onChange: function onChange(d, state) {\n        // Wipe color registry if all objects are new\n        [d.nodes, d.links].every(function (arr) {\n          return (arr || []).every(function (d) {\n            return !d.hasOwnProperty('__indexColor');\n          });\n        }) && state.colorTracker.reset();\n        [{\n          type: 'Node',\n          objs: d.nodes\n        }, {\n          type: 'Link',\n          objs: d.links\n        }].forEach(hexIndex);\n        state.forceGraph.graphData(d);\n        state.shadowGraph.graphData(d);\n        function hexIndex(_ref4) {\n          var type = _ref4.type,\n            objs = _ref4.objs;\n          objs.filter(function (d) {\n            if (!d.hasOwnProperty('__indexColor')) return true;\n            var cur = state.colorTracker.lookup(d.__indexColor);\n            return !cur || !cur.hasOwnProperty('d') || cur.d !== d;\n          }).forEach(function (d) {\n            // store object lookup color\n            d.__indexColor = state.colorTracker.register({\n              type: type,\n              d: d\n            });\n          });\n        }\n      },\n      triggerUpdate: false\n    },\n    backgroundColor: {\n      onChange: function onChange(color, state) {\n        state.canvas && color && (state.canvas.style.background = color);\n      },\n      triggerUpdate: false\n    },\n    nodeLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    nodePointerAreaPaint: {\n      onChange: function onChange(paintFn, state) {\n        state.shadowGraph.nodeCanvasObject(!paintFn ? null : function (node, ctx, globalScale) {\n          return paintFn(node, node.__indexColor, ctx, globalScale);\n        });\n        state.flushShadowCanvas && state.flushShadowCanvas();\n      },\n      triggerUpdate: false\n    },\n    linkPointerAreaPaint: {\n      onChange: function onChange(paintFn, state) {\n        state.shadowGraph.linkCanvasObject(!paintFn ? null : function (link, ctx, globalScale) {\n          return paintFn(link, link.__indexColor, ctx, globalScale);\n        });\n        state.flushShadowCanvas && state.flushShadowCanvas();\n      },\n      triggerUpdate: false\n    },\n    linkLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkHoverPrecision: {\n      \"default\": 4,\n      triggerUpdate: false\n    },\n    minZoom: {\n      \"default\": 0.01,\n      onChange: function onChange(minZoom, state) {\n        state.zoom.scaleExtent([minZoom, state.zoom.scaleExtent()[1]]);\n      },\n      triggerUpdate: false\n    },\n    maxZoom: {\n      \"default\": 1000,\n      onChange: function onChange(maxZoom, state) {\n        state.zoom.scaleExtent([state.zoom.scaleExtent()[0], maxZoom]);\n      },\n      triggerUpdate: false\n    },\n    enableNodeDrag: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enableZoomInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enablePanInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enableZoomPanInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    // to be deprecated\n    enablePointerInteraction: {\n      \"default\": true,\n      onChange: function onChange(_, state) {\n        state.hoverObj = null;\n      },\n      triggerUpdate: false\n    },\n    autoPauseRedraw: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    onNodeDrag: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeDragEnd: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeClick: {\n      triggerUpdate: false\n    },\n    onNodeRightClick: {\n      triggerUpdate: false\n    },\n    onNodeHover: {\n      triggerUpdate: false\n    },\n    onLinkClick: {\n      triggerUpdate: false\n    },\n    onLinkRightClick: {\n      triggerUpdate: false\n    },\n    onLinkHover: {\n      triggerUpdate: false\n    },\n    onBackgroundClick: {\n      triggerUpdate: false\n    },\n    onBackgroundRightClick: {\n      triggerUpdate: false\n    },\n    onZoom: {\n      triggerUpdate: false\n    },\n    onZoomEnd: {\n      triggerUpdate: false\n    },\n    onRenderFramePre: {\n      triggerUpdate: false\n    },\n    onRenderFramePost: {\n      triggerUpdate: false\n    }\n  }, linkedProps),\n  aliases: {\n    // Prop names supported for backwards compatibility\n    stopAnimation: 'pauseAnimation'\n  },\n  methods: _objectSpread2({\n    graph2ScreenCoords: function graph2ScreenCoords(state, x, y) {\n      var t = zoomTransform(state.canvas);\n      return {\n        x: x * t.k + t.x,\n        y: y * t.k + t.y\n      };\n    },\n    screen2GraphCoords: function screen2GraphCoords(state, x, y) {\n      var t = zoomTransform(state.canvas);\n      return {\n        x: (x - t.x) / t.k,\n        y: (y - t.y) / t.k\n      };\n    },\n    centerAt: function centerAt(state, x, y, transitionDuration) {\n      if (!state.canvas) return null; // no canvas yet\n\n      // setter\n      if (x !== undefined || y !== undefined) {\n        var finalPos = Object.assign({}, x !== undefined ? {\n          x: x\n        } : {}, y !== undefined ? {\n          y: y\n        } : {});\n        if (!transitionDuration) {\n          // no animation\n          setCenter(finalPos);\n        } else {\n          state.tweenGroup.add(new Tween(getCenter()).to(finalPos, transitionDuration).easing(Easing.Quadratic.Out).onUpdate(setCenter).start());\n        }\n        return this;\n      }\n\n      // getter\n      return getCenter();\n\n      //\n\n      function getCenter() {\n        var t = zoomTransform(state.canvas);\n        return {\n          x: (state.width / 2 - t.x) / t.k,\n          y: (state.height / 2 - t.y) / t.k\n        };\n      }\n      function setCenter(_ref5) {\n        var x = _ref5.x,\n          y = _ref5.y;\n        state.zoom.translateTo(state.zoom.__baseElem, x === undefined ? getCenter().x : x, y === undefined ? getCenter().y : y);\n        state.needsRedraw = true;\n      }\n    },\n    zoom: function zoom(state, k, transitionDuration) {\n      if (!state.canvas) return null; // no canvas yet\n\n      // setter\n      if (k !== undefined) {\n        if (!transitionDuration) {\n          // no animation\n          setZoom(k);\n        } else {\n          state.tweenGroup.add(new Tween({\n            k: getZoom()\n          }).to({\n            k: k\n          }, transitionDuration).easing(Easing.Quadratic.Out).onUpdate(function (_ref6) {\n            var k = _ref6.k;\n            return setZoom(k);\n          }).start());\n        }\n        return this;\n      }\n\n      // getter\n      return getZoom();\n\n      //\n\n      function getZoom() {\n        return zoomTransform(state.canvas).k;\n      }\n      function setZoom(k) {\n        state.zoom.scaleTo(state.zoom.__baseElem, k);\n        state.needsRedraw = true;\n      }\n    },\n    zoomToFit: function zoomToFit(state) {\n      var transitionDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var padding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10;\n      for (var _len = arguments.length, bboxArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n        bboxArgs[_key - 3] = arguments[_key];\n      }\n      var bbox = this.getGraphBbox.apply(this, bboxArgs);\n      if (bbox) {\n        var center = {\n          x: (bbox.x[0] + bbox.x[1]) / 2,\n          y: (bbox.y[0] + bbox.y[1]) / 2\n        };\n        var zoomK = Math.max(1e-12, Math.min(1e12, (state.width - padding * 2) / (bbox.x[1] - bbox.x[0]), (state.height - padding * 2) / (bbox.y[1] - bbox.y[0])));\n        this.centerAt(center.x, center.y, transitionDuration);\n        this.zoom(zoomK, transitionDuration);\n      }\n      return this;\n    },\n    getGraphBbox: function getGraphBbox(state) {\n      var nodeFilter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {\n        return true;\n      };\n      var getVal = accessorFn(state.nodeVal);\n      var getR = function getR(node) {\n        return Math.sqrt(Math.max(0, getVal(node) || 1)) * state.nodeRelSize;\n      };\n      var nodesPos = state.graphData.nodes.filter(nodeFilter).map(function (node) {\n        return {\n          x: node.x,\n          y: node.y,\n          r: getR(node)\n        };\n      });\n      return !nodesPos.length ? null : {\n        x: [min(nodesPos, function (node) {\n          return node.x - node.r;\n        }), max(nodesPos, function (node) {\n          return node.x + node.r;\n        })],\n        y: [min(nodesPos, function (node) {\n          return node.y - node.r;\n        }), max(nodesPos, function (node) {\n          return node.y + node.r;\n        })]\n      };\n    },\n    pauseAnimation: function pauseAnimation(state) {\n      if (state.animationFrameRequestId) {\n        cancelAnimationFrame(state.animationFrameRequestId);\n        state.animationFrameRequestId = null;\n      }\n      return this;\n    },\n    resumeAnimation: function resumeAnimation(state) {\n      if (!state.animationFrameRequestId) {\n        this._animationCycle();\n      }\n      return this;\n    },\n    _destructor: function _destructor() {\n      this.pauseAnimation();\n      this.graphData({\n        nodes: [],\n        links: []\n      });\n    }\n  }, linkedMethods),\n  stateInit: function stateInit() {\n    return {\n      lastSetZoom: 1,\n      zoom: zoom(),\n      forceGraph: new CanvasForceGraph(),\n      shadowGraph: new CanvasForceGraph().cooldownTicks(0).nodeColor('__indexColor').linkColor('__indexColor').isShadow(true),\n      colorTracker: new ColorTracker(),\n      // indexed objects for rgb lookup\n      tweenGroup: new Group()\n    };\n  },\n  init: function init(domNode, state) {\n    var _this = this;\n    // Wipe DOM\n    domNode.innerHTML = '';\n\n    // Container anchor for canvas and tooltip\n    var container = document.createElement('div');\n    container.classList.add('force-graph-container');\n    container.style.position = 'relative';\n    domNode.appendChild(container);\n    state.canvas = document.createElement('canvas');\n    if (state.backgroundColor) state.canvas.style.background = state.backgroundColor;\n    container.appendChild(state.canvas);\n    state.shadowCanvas = document.createElement('canvas');\n\n    // Show shadow canvas\n    //state.shadowCanvas.style.position = 'absolute';\n    //state.shadowCanvas.style.top = '0';\n    //state.shadowCanvas.style.left = '0';\n    //container.appendChild(state.shadowCanvas);\n\n    var ctx = state.canvas.getContext('2d');\n    var shadowCtx = state.shadowCanvas.getContext('2d', {\n      willReadFrequently: true\n    });\n    var pointerPos = {\n      x: -1e12,\n      y: -1e12\n    };\n    var getObjUnderPointer = function getObjUnderPointer() {\n      var obj = null;\n      var pxScale = window.devicePixelRatio;\n      var px = pointerPos.x > 0 && pointerPos.y > 0 ? shadowCtx.getImageData(pointerPos.x * pxScale, pointerPos.y * pxScale, 1, 1) : null;\n      // Lookup object per pixel color\n      px && (obj = state.colorTracker.lookup(px.data));\n      return obj;\n    };\n\n    // Setup node drag interaction\n    select(state.canvas).call(drag().subject(function () {\n      if (!state.enableNodeDrag) {\n        return null;\n      }\n      var obj = getObjUnderPointer();\n      return obj && obj.type === 'Node' ? obj.d : null; // Only drag nodes\n    }).on('start', function (ev) {\n      var obj = ev.subject;\n      obj.__initialDragPos = {\n        x: obj.x,\n        y: obj.y,\n        fx: obj.fx,\n        fy: obj.fy\n      };\n\n      // keep engine running at low intensity throughout drag\n      if (!ev.active) {\n        obj.fx = obj.x;\n        obj.fy = obj.y; // Fix points\n      }\n\n      // drag cursor\n      state.canvas.classList.add('grabbable');\n    }).on('drag', function (ev) {\n      var obj = ev.subject;\n      var initPos = obj.__initialDragPos;\n      var dragPos = ev;\n      var k = zoomTransform(state.canvas).k;\n      var translate = {\n        x: initPos.x + (dragPos.x - initPos.x) / k - obj.x,\n        y: initPos.y + (dragPos.y - initPos.y) / k - obj.y\n      };\n\n      // Move fx/fy (and x/y) of nodes based on the scaled drag distance since the drag start\n      ['x', 'y'].forEach(function (c) {\n        return obj[\"f\".concat(c)] = obj[c] = initPos[c] + (dragPos[c] - initPos[c]) / k;\n      });\n\n      // Only engage full drag if distance reaches above threshold\n      if (!obj.__dragged && DRAG_CLICK_TOLERANCE_PX >= Math.sqrt(sum(['x', 'y'].map(function (k) {\n        return Math.pow(ev[k] - initPos[k], 2);\n      })))) return;\n      state.forceGraph.d3AlphaTarget(0.3) // keep engine running at low intensity throughout drag\n      .resetCountdown(); // prevent freeze while dragging\n\n      state.isPointerDragging = true;\n      obj.__dragged = true;\n      state.onNodeDrag(obj, translate);\n    }).on('end', function (ev) {\n      var obj = ev.subject;\n      var initPos = obj.__initialDragPos;\n      var translate = {\n        x: obj.x - initPos.x,\n        y: obj.y - initPos.y\n      };\n      if (initPos.fx === undefined) {\n        obj.fx = undefined;\n      }\n      if (initPos.fy === undefined) {\n        obj.fy = undefined;\n      }\n      delete obj.__initialDragPos;\n      if (state.forceGraph.d3AlphaTarget()) {\n        state.forceGraph.d3AlphaTarget(0) // release engine low intensity\n        .resetCountdown(); // let the engine readjust after releasing fixed nodes\n      }\n\n      // drag cursor\n      state.canvas.classList.remove('grabbable');\n      state.isPointerDragging = false;\n      if (obj.__dragged) {\n        delete obj.__dragged;\n        state.onNodeDragEnd(obj, translate);\n      }\n    }));\n\n    // Setup zoom / pan interaction\n    state.zoom(state.zoom.__baseElem = select(state.canvas)); // Attach controlling elem for easy access\n\n    state.zoom.__baseElem.on('dblclick.zoom', null); // Disable double-click to zoom\n\n    state.zoom.filter(function (ev) {\n      return (\n        // disable zoom interaction\n        !ev.button && state.enableZoomPanInteraction && (ev.type !== 'wheel' || accessorFn(state.enableZoomInteraction)(ev)) && (ev.type === 'wheel' || accessorFn(state.enablePanInteraction)(ev))\n      );\n    }).on('zoom', function (ev) {\n      var t = ev.transform;\n      [ctx, shadowCtx].forEach(function (c) {\n        resetTransform(c);\n        c.translate(t.x, t.y);\n        c.scale(t.k, t.k);\n      });\n      state.isPointerDragging = true;\n      state.onZoom && state.onZoom(_objectSpread2(_objectSpread2({}, t), _this.centerAt())); // report x,y coordinates relative to canvas center\n      state.needsRedraw = true;\n    }).on('end', function (ev) {\n      state.isPointerDragging = false;\n      state.onZoomEnd && state.onZoomEnd(_objectSpread2(_objectSpread2({}, ev.transform), _this.centerAt()));\n    });\n    adjustCanvasSize(state);\n    state.forceGraph.onNeedsRedraw(function () {\n      return state.needsRedraw = true;\n    }).onFinishUpdate(function () {\n      // re-zoom, if still in default position (not user modified)\n      if (zoomTransform(state.canvas).k === state.lastSetZoom && state.graphData.nodes.length) {\n        state.zoom.scaleTo(state.zoom.__baseElem, state.lastSetZoom = ZOOM2NODES_FACTOR / Math.cbrt(state.graphData.nodes.length));\n        state.needsRedraw = true;\n      }\n    });\n\n    // Setup tooltip\n    state.tooltip = new Tooltip(container);\n\n    // Capture pointer coords on move or touchstart\n    ['pointermove', 'pointerdown'].forEach(function (evType) {\n      return container.addEventListener(evType, function (ev) {\n        if (evType === 'pointerdown') {\n          state.isPointerPressed = true; // track click state\n          state.pointerDownEvent = ev;\n        }\n\n        // detect pointer drag on canvas pan\n        !state.isPointerDragging && ev.type === 'pointermove' && state.onBackgroundClick // only bother detecting drags this way if background clicks are enabled (so they don't trigger accidentally on canvas panning)\n        && (ev.pressure > 0 || state.isPointerPressed) // ev.pressure always 0 on Safari, so we use the isPointerPressed tracker\n        && (ev.pointerType === 'mouse' || ev.movementX === undefined || [ev.movementX, ev.movementY].some(function (m) {\n          return Math.abs(m) > 1;\n        })) // relax drag trigger sensitivity on non-mouse (touch/pen) events\n        && (state.isPointerDragging = true);\n\n        // update the pointer pos\n        var offset = getOffset(container);\n        pointerPos.x = ev.pageX - offset.left;\n        pointerPos.y = ev.pageY - offset.top;\n\n        //\n\n        function getOffset(el) {\n          var rect = el.getBoundingClientRect(),\n            scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,\n            scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n          return {\n            top: rect.top + scrollTop,\n            left: rect.left + scrollLeft\n          };\n        }\n      }, {\n        passive: true\n      });\n    });\n\n    // Handle click/touch events on nodes/links\n    container.addEventListener('pointerup', function (ev) {\n      if (!state.isPointerPressed) {\n        return; // don't trigger click events if pointer is not pressed on the canvas\n      }\n      state.isPointerPressed = false;\n      if (state.isPointerDragging) {\n        state.isPointerDragging = false;\n        return; // don't trigger click events after pointer drag (pan / node drag functionality)\n      }\n      var cbEvents = [ev, state.pointerDownEvent];\n      requestAnimationFrame(function () {\n        // trigger click events asynchronously, to allow hoverObj to be set (on frame)\n        if (ev.button === 0) {\n          // mouse left-click or touch\n          if (state.hoverObj) {\n            var fn = state[\"on\".concat(state.hoverObj.type, \"Click\")];\n            fn && fn.apply(void 0, [state.hoverObj.d].concat(cbEvents));\n          } else {\n            state.onBackgroundClick && state.onBackgroundClick.apply(state, cbEvents);\n          }\n        }\n        if (ev.button === 2) {\n          // mouse right-click\n          if (state.hoverObj) {\n            var _fn = state[\"on\".concat(state.hoverObj.type, \"RightClick\")];\n            _fn && _fn.apply(void 0, [state.hoverObj.d].concat(cbEvents));\n          } else {\n            state.onBackgroundRightClick && state.onBackgroundRightClick.apply(state, cbEvents);\n          }\n        }\n      });\n    }, {\n      passive: true\n    });\n    container.addEventListener('contextmenu', function (ev) {\n      if (!state.onBackgroundRightClick && !state.onNodeRightClick && !state.onLinkRightClick) return true; // default contextmenu behavior\n      ev.preventDefault();\n      return false;\n    });\n    state.forceGraph(ctx);\n    state.shadowGraph(shadowCtx);\n\n    //\n\n    var refreshShadowCanvas = throttle(function () {\n      // wipe canvas\n      clearCanvas(shadowCtx, state.width, state.height);\n\n      // Adjust link hover area\n      state.shadowGraph.linkWidth(function (l) {\n        return accessorFn(state.linkWidth)(l) + state.linkHoverPrecision;\n      });\n\n      // redraw\n      var t = zoomTransform(state.canvas);\n      state.shadowGraph.globalScale(t.k).tickFrame();\n    }, HOVER_CANVAS_THROTTLE_DELAY);\n    state.flushShadowCanvas = refreshShadowCanvas.flush; // hook to immediately invoke shadow canvas paint\n\n    // Kick-off renderer\n    (this._animationCycle = function animate() {\n      // IIFE\n      var doRedraw = !state.autoPauseRedraw || !!state.needsRedraw || state.forceGraph.isEngineRunning() || state.graphData.links.some(function (d) {\n        return d.__photons && d.__photons.length;\n      });\n      state.needsRedraw = false;\n      if (state.enablePointerInteraction) {\n        // Update tooltip and trigger onHover events\n        var obj = !state.isPointerDragging ? getObjUnderPointer() : null; // don't hover during drag\n        if (obj !== state.hoverObj) {\n          var prevObj = state.hoverObj;\n          var prevObjType = prevObj ? prevObj.type : null;\n          var objType = obj ? obj.type : null;\n          if (prevObjType && prevObjType !== objType) {\n            // Hover out\n            var fn = state[\"on\".concat(prevObjType, \"Hover\")];\n            fn && fn(null, prevObj.d);\n          }\n          if (objType) {\n            // Hover in\n            var _fn2 = state[\"on\".concat(objType, \"Hover\")];\n            _fn2 && _fn2(obj.d, prevObjType === objType ? prevObj.d : null);\n          }\n          state.tooltip.content(obj ? accessorFn(state[\"\".concat(obj.type.toLowerCase(), \"Label\")])(obj.d) || null : null);\n\n          // set pointer if hovered object is clickable\n          state.canvas.classList[obj && state[\"on\".concat(objType, \"Click\")] || !obj && state.onBackgroundClick ? 'add' : 'remove']('clickable');\n          state.hoverObj = obj;\n        }\n        doRedraw && refreshShadowCanvas();\n      }\n      if (doRedraw) {\n        // Wipe canvas\n        clearCanvas(ctx, state.width, state.height);\n\n        // Frame cycle\n        var globalScale = zoomTransform(state.canvas).k;\n        state.onRenderFramePre && state.onRenderFramePre(ctx, globalScale);\n        state.forceGraph.globalScale(globalScale).tickFrame();\n        state.onRenderFramePost && state.onRenderFramePost(ctx, globalScale);\n      }\n      state.tweenGroup.update(); // update canvas animation tweens\n\n      state.animationFrameRequestId = requestAnimationFrame(animate);\n    })();\n  },\n  update: function updateFn(state) {}\n});\n\nexport { forceGraph as default };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}